import{c as ve,r as u,au as vr,j as e,R as na,f as je,av as aa,e as Es,C as oa,i as fe,aw as la,ax as ia,ay as ca,az as yr,P as da,O as ua,aA as ma,a as q,aB as br,I as qt,H as V,L as De,d as hs,u as Ts,h as ye,x as $e,l as fa,aC as jr,w as ha,m as pa,p as xa,n as ga,o as va,F as ya,D as ba,W as ja,v as L,J as wa,y as Et,z as Tt,A as kt,B as It,a9 as At,E as ks,G as Gt,Z as Fe,aD as wr,aE as He,_ as Sa,S as Na,aF as Ca,X as Sr,Y as _a,aG as Ea,at as Ta,K as ka,a0 as Ia,a1 as Aa,a2 as Te,a3 as Pa,a4 as Da,a5 as Ra,a6 as Ma,a7 as La,a8 as Oa}from"./product_logo-D13hEBab.js";import{B as Ua,P as Nr,a as Ke,e as Cr,o as Jt,s as he,n as ps,d as _r,f as Oe,c as it,I as de,b as Fa,u as Va,g as _e,S as Ba,R as Er,h as za}from"./mcpServerStorage-BmqUzA9I.js";import{B as Tr,c as Ws,T as Is,w as Ha,I as $a,u as As,e as Ka,s as Wa,m as ms,g as qs,U as Rt,f as kr,d as qa,r as Ga,a as Ja,b as Ya,R as Za}from"./textarea-CDYFAkeE.js";import{c as Ir,u as Xa,R as Qa,Y as eo,A as to,Z as Ar,$ as so,C as ro,a as no,o as ct,L as pt,O as Ps,Q as Ut,b as Pr,d as Dr,E as Se,a0 as ao,p as Yt,q as Zt,r as Xt,a1 as oo,a2 as lo,a3 as io,M as co,e as Rr,B as uo,a4 as mo,T as fo,a5 as ho,f as po,a6 as xo,a7 as go,a8 as vo,a9 as yo,aa as bo,ab as jo,ac as wo,ad as So,ae as No}from"./mermaid-NA5CF7SZ-BLmXvdgo.js";import{M as Mr,S as Co}from"./settings-CYF6iMPY.js";import{d as Ye}from"./dayjs.min-CusGE5tu.js";import{d as _o}from"./duration-CWiZJ4w7.js";import"./_arrayReduce-Dq31dRPX.js";import"./isArray-wghjNQ3q.js";(function(){try{var t=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};t.SENTRY_RELEASE={id:"cef3d2e981a8c76e9e817128ae6fc814ac1270e0"}}catch{}})();try{(function(){var t=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},r=new t.Error().stack;r&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[r]="ae59986c-e673-4de2-95d4-02652fc9d8d9",t._sentryDebugIdIdentifier="sentry-dbid-ae59986c-e673-4de2-95d4-02652fc9d8d9")})()}catch{}const Eo=[["path",{d:"M16 14v2.2l1.6 1",key:"fo4ql5"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M21 7.5V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h3.5",key:"1osxxc"}],["path",{d:"M3 10h5",key:"r794hk"}],["path",{d:"M8 2v4",key:"1cmpym"}],["circle",{cx:"16",cy:"16",r:"6",key:"qoo3c4"}]],Lr=ve("calendar-clock",Eo);const To=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],ko=ve("chevron-up",To);const Io=[["path",{d:"M21.54 15H17a2 2 0 0 0-2 2v4.54",key:"1djwo0"}],["path",{d:"M7 3.34V5a3 3 0 0 0 3 3a2 2 0 0 1 2 2c0 1.1.9 2 2 2a2 2 0 0 0 2-2c0-1.1.9-2 2-2h3.17",key:"1tzkfa"}],["path",{d:"M11 21.95V18a2 2 0 0 0-2-2a2 2 0 0 1-2-2v-1a2 2 0 0 0-2-2H2.05",key:"14pb5j"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Ao=ve("earth",Io);const Po=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],Or=ve("external-link",Po);const Do=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],Ro=ve("menu",Do);const Mo=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}],["path",{d:"M7.5 9.5c0 .687.265 1.383.697 1.844l3.009 3.264a1.14 1.14 0 0 0 .407.314 1 1 0 0 0 .783-.004 1.14 1.14 0 0 0 .398-.31l3.008-3.264A2.77 2.77 0 0 0 16.5 9.5 2.5 2.5 0 0 0 12 8a2.5 2.5 0 0 0-4.5 1.5",key:"1faxuh"}]],Ur=ve("message-square-heart",Mo);const Lo=[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]],Fr=ve("palette",Lo);const Oo=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],Uo=ve("pencil",Oo);const Fo=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],Vo=ve("play",Fo);const Bo=[["path",{d:"M6.3 20.3a2.4 2.4 0 0 0 3.4 0L12 18l-6-6-2.3 2.3a2.4 2.4 0 0 0 0 3.4Z",key:"goz73y"}],["path",{d:"m2 22 3-3",key:"19mgm9"}],["path",{d:"M7.5 13.5 10 11",key:"7xgeeb"}],["path",{d:"M10.5 16.5 13 14",key:"10btkg"}],["path",{d:"m18 3-4 4h6l-4 4",key:"16psg9"}]],zo=ve("plug-zap",Bo);const Ho=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],Ds=ve("rotate-ccw",Ho);const $o=[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]],lt=ve("server",$o);const Ko=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],Wo=ve("square",Ko);const qo=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Qt=ve("trash-2",qo);const Go=[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.106-3.105c.32-.322.863-.22.983.218a6 6 0 0 1-8.259 7.057l-7.91 7.91a1 1 0 0 1-2.999-3l7.91-7.91a6 6 0 0 1 7.057-8.259c.438.12.54.662.219.984z",key:"1ngwbx"}]],Jo=ve("wrench",Go);var Vr="AlertDialog",[Yo]=Es(Vr,[vr]),Ve=vr(),Br=t=>{const{__scopeAlertDialog:r,...s}=t,n=Ve(r);return e.jsx(na,{...n,...s,modal:!0})};Br.displayName=Vr;var Zo="AlertDialogTrigger",Xo=u.forwardRef((t,r)=>{const{__scopeAlertDialog:s,...n}=t,a=Ve(s);return e.jsx(ma,{...a,...n,ref:r})});Xo.displayName=Zo;var Qo="AlertDialogPortal",zr=t=>{const{__scopeAlertDialog:r,...s}=t,n=Ve(r);return e.jsx(da,{...n,...s})};zr.displayName=Qo;var el="AlertDialogOverlay",Hr=u.forwardRef((t,r)=>{const{__scopeAlertDialog:s,...n}=t,a=Ve(s);return e.jsx(ua,{...a,...n,ref:r})});Hr.displayName=el;var at="AlertDialogContent",[tl,sl]=Yo(at),rl=la("AlertDialogContent"),$r=u.forwardRef((t,r)=>{const{__scopeAlertDialog:s,children:n,...a}=t,o=Ve(s),l=u.useRef(null),i=je(r,l),d=u.useRef(null);return e.jsx(aa,{contentName:at,titleName:Kr,docsSlug:"alert-dialog",children:e.jsx(tl,{scope:s,cancelRef:d,children:e.jsxs(oa,{role:"alertdialog",...o,...a,ref:i,onOpenAutoFocus:fe(a.onOpenAutoFocus,m=>{m.preventDefault(),d.current?.focus({preventScroll:!0})}),onPointerDownOutside:m=>m.preventDefault(),onInteractOutside:m=>m.preventDefault(),children:[e.jsx(rl,{children:n}),e.jsx(al,{contentRef:l})]})})})});$r.displayName=at;var Kr="AlertDialogTitle",Wr=u.forwardRef((t,r)=>{const{__scopeAlertDialog:s,...n}=t,a=Ve(s);return e.jsx(ia,{...a,...n,ref:r})});Wr.displayName=Kr;var qr="AlertDialogDescription",Gr=u.forwardRef((t,r)=>{const{__scopeAlertDialog:s,...n}=t,a=Ve(s);return e.jsx(ca,{...a,...n,ref:r})});Gr.displayName=qr;var nl="AlertDialogAction",Jr=u.forwardRef((t,r)=>{const{__scopeAlertDialog:s,...n}=t,a=Ve(s);return e.jsx(yr,{...a,...n,ref:r})});Jr.displayName=nl;var Yr="AlertDialogCancel",Zr=u.forwardRef((t,r)=>{const{__scopeAlertDialog:s,...n}=t,{cancelRef:a}=sl(Yr,s),o=Ve(s),l=je(r,a);return e.jsx(yr,{...o,...n,ref:l})});Zr.displayName=Yr;var al=({contentRef:t})=>{const r=`\`${at}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${at}\` by passing a \`${qr}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${at}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return u.useEffect(()=>{document.getElementById(t.current?.getAttribute("aria-describedby"))||console.warn(r)},[r,t]),null},ol=Br,ll=zr,il=Hr,cl=$r,dl=Jr,ul=Zr,ml=Wr,fl=Gr;function yt({...t}){return e.jsx(ol,{"data-slot":"alert-dialog",...t})}function hl({...t}){return e.jsx(ll,{"data-slot":"alert-dialog-portal",...t})}function pl({className:t,...r}){return e.jsx(il,{"data-slot":"alert-dialog-overlay",className:q("data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50 backdrop-blur-[2px] data-[state=closed]:animate-out data-[state=open]:animate-in",t),...r})}function bt({className:t,...r}){return e.jsxs(hl,{children:[e.jsx(pl,{}),e.jsx(cl,{"data-slot":"alert-dialog-content",className:q("data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border bg-background p-6 shadow-lg duration-200 data-[state=closed]:animate-out data-[state=open]:animate-in sm:max-w-lg",t),...r})]})}function jt({className:t,...r}){return e.jsx("div",{"data-slot":"alert-dialog-header",className:q("flex flex-col gap-2 text-center sm:text-left",t),...r})}function wt({className:t,...r}){return e.jsx("div",{"data-slot":"alert-dialog-footer",className:q("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",t),...r})}function St({className:t,...r}){return e.jsx(ml,{"data-slot":"alert-dialog-title",className:q("font-semibold text-lg",t),...r})}function Nt({className:t,...r}){return e.jsx(fl,{"data-slot":"alert-dialog-description",className:q("text-muted-foreground text-sm",t),...r})}function Ct({className:t,...r}){return e.jsx(dl,{className:q(br(),t),...r})}function _t({className:t,...r}){return e.jsx(ul,{className:q(br({variant:"outline"}),t),...r})}async function Xr(t,r){const s=performance.now();try{const a=await(await fetch(`${r}/test-provider`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({provider:t.type,model:t.modelId,apiKey:t.apiKey,baseUrl:t.baseUrl,resourceName:t.resourceName,region:t.region,accessKeyId:t.accessKeyId,secretAccessKey:t.secretAccessKey,sessionToken:t.sessionToken})})).json();return a.responseTime||(a.responseTime=Math.round(performance.now()-s)),a}catch(n){const a=Math.round(performance.now()-s);return n instanceof Error?{success:!1,message:n.message,responseTime:a}:{success:!1,message:"An unexpected error occurred",responseTime:a}}}const xl=({provider:t,isSelected:r,isBuiltIn:s,onSelect:n,onTest:a,onEdit:o,onDelete:l,isTesting:i=!1})=>{const d=`provider-${t.id}`;return e.jsxs("label",{htmlFor:d,className:q("group flex w-full cursor-pointer items-center gap-4 rounded-xl border p-4 text-left transition-all",r?"border-[var(--accent-orange)] bg-[var(--accent-orange)]/5 shadow-md":"border-border bg-card hover:border-[var(--accent-orange)]/50 hover:shadow-sm"),children:[e.jsx("input",{type:"radio",id:d,name:"default-provider",className:"sr-only",checked:r,onChange:()=>n()}),e.jsx("div",{className:q("flex h-5 w-5 shrink-0 items-center justify-center rounded-full border-2 transition-all",r?"border-[var(--accent-orange)] bg-[var(--accent-orange)]":"border-border"),children:r&&e.jsx(qt,{className:"h-3 w-3 text-white"})}),e.jsx("div",{className:"flex h-10 w-10 shrink-0 items-center justify-center rounded-lg bg-[var(--accent-orange)]/10 text-[var(--accent-orange)]",children:s?e.jsx(Ua,{size:24}):e.jsx(Nr,{type:t.type,size:24})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"mb-1 flex items-center gap-2",children:[e.jsx("span",{className:"font-semibold",children:t.name}),r&&e.jsx(Tr,{variant:"secondary",className:"rounded bg-[var(--accent-orange)]/10 text-[var(--accent-orange)]",children:"DEFAULT"})]}),e.jsx("p",{className:"truncate text-muted-foreground text-sm",children:s?"Model hosted on the cloud by BrowserOS, has strict rate limits":`${t.modelId} • ${t.baseUrl}`})]}),!s&&e.jsxs("div",{className:"flex shrink-0 items-center gap-2",children:[e.jsxs(V,{variant:"outline",size:"sm",disabled:i,onClick:()=>a?.(),children:[i&&e.jsx(De,{className:"mr-1.5 h-4 w-4 animate-spin"}),i?"Testing...":"Test"]}),e.jsx(V,{variant:"outline",size:"sm",onClick:()=>o?.(),children:"Edit"}),e.jsx(V,{variant:"ghost",size:"icon-sm",className:"text-muted-foreground hover:bg-destructive/10 hover:text-destructive",onClick:()=>l?.(),children:e.jsx(Qt,{className:"h-4 w-4"})})]})]})},gl=({providers:t,selectedProviderId:r,testingProviderId:s,onSelectProvider:n,onTestProvider:a,onEditProvider:o,onDeleteProvider:l})=>e.jsx("div",{className:"space-y-3",children:t.map(i=>{const d=i.id==="browseros";return e.jsx(xl,{provider:i,isSelected:r===i.id,isBuiltIn:d,isTesting:s===i.id,onSelect:()=>n(i.id),onTest:()=>a(i),onEdit:()=>o(i),onDelete:()=>l(i)},i.id)})});var vl=[" ","Enter","ArrowUp","ArrowDown"],yl=[" ","Enter"],Ze="Select",[es,ts,bl]=eo(Ze),[dt]=Es(Ze,[bl,Ir]),ss=Ir(),[jl,We]=dt(Ze),[wl,Sl]=dt(Ze),Qr=t=>{const{__scopeSelect:r,children:s,open:n,defaultOpen:a,onOpenChange:o,value:l,defaultValue:i,onValueChange:d,dir:m,name:h,autoComplete:y,disabled:C,required:x,form:_}=t,b=ss(r),[E,w]=u.useState(null),[v,p]=u.useState(null),[j,k]=u.useState(!1),B=Xa(m),[P,Y]=hs({prop:n,defaultProp:a??!1,onChange:o,caller:Ze}),[ne,O]=hs({prop:l,defaultProp:i,onChange:d,caller:Ze}),ae=u.useRef(null),R=E?_||!!E.closest("form"):!0,[U,z]=u.useState(new Set),K=Array.from(U).map(W=>W.props.value).join(";");return e.jsx(Qa,{...b,children:e.jsxs(jl,{required:x,scope:r,trigger:E,onTriggerChange:w,valueNode:v,onValueNodeChange:p,valueNodeHasChildren:j,onValueNodeHasChildrenChange:k,contentId:Ts(),value:ne,onValueChange:O,open:P,onOpenChange:Y,dir:B,triggerPointerDownPosRef:ae,disabled:C,children:[e.jsx(es.Provider,{scope:r,children:e.jsx(wl,{scope:t.__scopeSelect,onNativeOptionAdd:u.useCallback(W=>{z(Z=>new Set(Z).add(W))},[]),onNativeOptionRemove:u.useCallback(W=>{z(Z=>{const S=new Set(Z);return S.delete(W),S})},[]),children:s})}),R?e.jsxs(wn,{"aria-hidden":!0,required:x,tabIndex:-1,name:h,autoComplete:y,value:ne,onChange:W=>O(W.target.value),disabled:C,form:_,children:[ne===void 0?e.jsx("option",{value:""}):null,Array.from(U)]},K):null]})})};Qr.displayName=Ze;var en="SelectTrigger",tn=u.forwardRef((t,r)=>{const{__scopeSelect:s,disabled:n=!1,...a}=t,o=ss(s),l=We(en,s),i=l.disabled||n,d=je(r,l.onTriggerChange),m=ts(s),h=u.useRef("touch"),[y,C,x]=Nn(b=>{const E=m().filter(p=>!p.disabled),w=E.find(p=>p.value===l.value),v=Cn(E,b,w);v!==void 0&&l.onValueChange(v.value)}),_=b=>{i||(l.onOpenChange(!0),x()),b&&(l.triggerPointerDownPosRef.current={x:Math.round(b.pageX),y:Math.round(b.pageY)})};return e.jsx(to,{asChild:!0,...o,children:e.jsx(ye.button,{type:"button",role:"combobox","aria-controls":l.contentId,"aria-expanded":l.open,"aria-required":l.required,"aria-autocomplete":"none",dir:l.dir,"data-state":l.open?"open":"closed",disabled:i,"data-disabled":i?"":void 0,"data-placeholder":Sn(l.value)?"":void 0,...a,ref:d,onClick:fe(a.onClick,b=>{b.currentTarget.focus(),h.current!=="mouse"&&_(b)}),onPointerDown:fe(a.onPointerDown,b=>{h.current=b.pointerType;const E=b.target;E.hasPointerCapture(b.pointerId)&&E.releasePointerCapture(b.pointerId),b.button===0&&b.ctrlKey===!1&&b.pointerType==="mouse"&&(_(b),b.preventDefault())}),onKeyDown:fe(a.onKeyDown,b=>{const E=y.current!=="";!(b.ctrlKey||b.altKey||b.metaKey)&&b.key.length===1&&C(b.key),!(E&&b.key===" ")&&vl.includes(b.key)&&(_(),b.preventDefault())})})})});tn.displayName=en;var sn="SelectValue",rn=u.forwardRef((t,r)=>{const{__scopeSelect:s,className:n,style:a,children:o,placeholder:l="",...i}=t,d=We(sn,s),{onValueNodeHasChildrenChange:m}=d,h=o!==void 0,y=je(r,d.onValueNodeChange);return $e(()=>{m(h)},[m,h]),e.jsx(ye.span,{...i,ref:y,style:{pointerEvents:"none"},children:Sn(d.value)?e.jsx(e.Fragment,{children:l}):o})});rn.displayName=sn;var Nl="SelectIcon",nn=u.forwardRef((t,r)=>{const{__scopeSelect:s,children:n,...a}=t;return e.jsx(ye.span,{"aria-hidden":!0,...a,ref:r,children:n||"▼"})});nn.displayName=Nl;var Cl="SelectPortal",an=t=>e.jsx(fa,{asChild:!0,...t});an.displayName=Cl;var Xe="SelectContent",on=u.forwardRef((t,r)=>{const s=We(Xe,t.__scopeSelect),[n,a]=u.useState();if($e(()=>{a(new DocumentFragment)},[]),!s.open){const o=n;return o?jr.createPortal(e.jsx(ln,{scope:t.__scopeSelect,children:e.jsx(es.Slot,{scope:t.__scopeSelect,children:e.jsx("div",{children:t.children})})}),o):null}return e.jsx(cn,{...t,ref:r})});on.displayName=Xe;var ke=10,[ln,qe]=dt(Xe),_l="SelectContentImpl",El=va("SelectContent.RemoveScroll"),cn=u.forwardRef((t,r)=>{const{__scopeSelect:s,position:n="item-aligned",onCloseAutoFocus:a,onEscapeKeyDown:o,onPointerDownOutside:l,side:i,sideOffset:d,align:m,alignOffset:h,arrowPadding:y,collisionBoundary:C,collisionPadding:x,sticky:_,hideWhenDetached:b,avoidCollisions:E,...w}=t,v=We(Xe,s),[p,j]=u.useState(null),[k,B]=u.useState(null),P=je(r,M=>j(M)),[Y,ne]=u.useState(null),[O,ae]=u.useState(null),R=ts(s),[U,z]=u.useState(!1),K=u.useRef(!1);u.useEffect(()=>{if(p)return pa(p)},[p]),xa();const W=u.useCallback(M=>{const[oe,...pe]=R().map(ie=>ie.ref.current),[G]=pe.slice(-1),X=document.activeElement;for(const ie of M)if(ie===X||(ie?.scrollIntoView({block:"nearest"}),ie===oe&&k&&(k.scrollTop=0),ie===G&&k&&(k.scrollTop=k.scrollHeight),ie?.focus(),document.activeElement!==X))return},[R,k]),Z=u.useCallback(()=>W([Y,p]),[W,Y,p]);u.useEffect(()=>{U&&Z()},[U,Z]);const{onOpenChange:S,triggerPointerDownPosRef:F}=v;u.useEffect(()=>{if(p){let M={x:0,y:0};const oe=G=>{M={x:Math.abs(Math.round(G.pageX)-(F.current?.x??0)),y:Math.abs(Math.round(G.pageY)-(F.current?.y??0))}},pe=G=>{M.x<=10&&M.y<=10?G.preventDefault():p.contains(G.target)||S(!1),document.removeEventListener("pointermove",oe),F.current=null};return F.current!==null&&(document.addEventListener("pointermove",oe),document.addEventListener("pointerup",pe,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",oe),document.removeEventListener("pointerup",pe,{capture:!0})}}},[p,S,F]),u.useEffect(()=>{const M=()=>S(!1);return window.addEventListener("blur",M),window.addEventListener("resize",M),()=>{window.removeEventListener("blur",M),window.removeEventListener("resize",M)}},[S]);const[Ee,Ge]=Nn(M=>{const oe=R().filter(X=>!X.disabled),pe=oe.find(X=>X.ref.current===document.activeElement),G=Cn(oe,M,pe);G&&setTimeout(()=>G.ref.current.focus())}),Qe=u.useCallback((M,oe,pe)=>{const G=!K.current&&!pe;(v.value!==void 0&&v.value===oe||G)&&(ne(M),G&&(K.current=!0))},[v.value]),ut=u.useCallback(()=>p?.focus(),[p]),Re=u.useCallback((M,oe,pe)=>{const G=!K.current&&!pe;(v.value!==void 0&&v.value===oe||G)&&ae(M)},[v.value]),et=n==="popper"?xs:dn,Be=et===xs?{side:i,sideOffset:d,align:m,alignOffset:h,arrowPadding:y,collisionBoundary:C,collisionPadding:x,sticky:_,hideWhenDetached:b,avoidCollisions:E}:{};return e.jsx(ln,{scope:s,content:p,viewport:k,onViewportChange:B,itemRefCallback:Qe,selectedItem:Y,onItemLeave:ut,itemTextRefCallback:Re,focusSelectedItem:Z,selectedItemText:O,position:n,isPositioned:U,searchRef:Ee,children:e.jsx(ga,{as:El,allowPinchZoom:!0,children:e.jsx(ya,{asChild:!0,trapped:v.open,onMountAutoFocus:M=>{M.preventDefault()},onUnmountAutoFocus:fe(a,M=>{v.trigger?.focus({preventScroll:!0}),M.preventDefault()}),children:e.jsx(ba,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:o,onPointerDownOutside:l,onFocusOutside:M=>M.preventDefault(),onDismiss:()=>v.onOpenChange(!1),children:e.jsx(et,{role:"listbox",id:v.contentId,"data-state":v.open?"open":"closed",dir:v.dir,onContextMenu:M=>M.preventDefault(),...w,...Be,onPlaced:()=>z(!0),ref:P,style:{display:"flex",flexDirection:"column",outline:"none",...w.style},onKeyDown:fe(w.onKeyDown,M=>{const oe=M.ctrlKey||M.altKey||M.metaKey;if(M.key==="Tab"&&M.preventDefault(),!oe&&M.key.length===1&&Ge(M.key),["ArrowUp","ArrowDown","Home","End"].includes(M.key)){let G=R().filter(X=>!X.disabled).map(X=>X.ref.current);if(["ArrowUp","End"].includes(M.key)&&(G=G.slice().reverse()),["ArrowUp","ArrowDown"].includes(M.key)){const X=M.target,ie=G.indexOf(X);G=G.slice(ie+1)}setTimeout(()=>W(G)),M.preventDefault()}})})})})})})});cn.displayName=_l;var Tl="SelectItemAlignedPosition",dn=u.forwardRef((t,r)=>{const{__scopeSelect:s,onPlaced:n,...a}=t,o=We(Xe,s),l=qe(Xe,s),[i,d]=u.useState(null),[m,h]=u.useState(null),y=je(r,P=>h(P)),C=ts(s),x=u.useRef(!1),_=u.useRef(!0),{viewport:b,selectedItem:E,selectedItemText:w,focusSelectedItem:v}=l,p=u.useCallback(()=>{if(o.trigger&&o.valueNode&&i&&m&&b&&E&&w){const P=o.trigger.getBoundingClientRect(),Y=m.getBoundingClientRect(),ne=o.valueNode.getBoundingClientRect(),O=w.getBoundingClientRect();if(o.dir!=="rtl"){const X=O.left-Y.left,ie=ne.left-X,Pe=P.left-ie,Me=P.width+Pe,tt=Math.max(Me,Y.width),st=window.innerWidth-ke,mt=Ws(ie,[ke,Math.max(ke,st-tt)]);i.style.minWidth=Me+"px",i.style.left=mt+"px"}else{const X=Y.right-O.right,ie=window.innerWidth-ne.right-X,Pe=window.innerWidth-P.right-ie,Me=P.width+Pe,tt=Math.max(Me,Y.width),st=window.innerWidth-ke,mt=Ws(ie,[ke,Math.max(ke,st-tt)]);i.style.minWidth=Me+"px",i.style.right=mt+"px"}const ae=C(),R=window.innerHeight-ke*2,U=b.scrollHeight,z=window.getComputedStyle(m),K=parseInt(z.borderTopWidth,10),W=parseInt(z.paddingTop,10),Z=parseInt(z.borderBottomWidth,10),S=parseInt(z.paddingBottom,10),F=K+W+U+S+Z,Ee=Math.min(E.offsetHeight*5,F),Ge=window.getComputedStyle(b),Qe=parseInt(Ge.paddingTop,10),ut=parseInt(Ge.paddingBottom,10),Re=P.top+P.height/2-ke,et=R-Re,Be=E.offsetHeight/2,M=E.offsetTop+Be,oe=K+W+M,pe=F-oe;if(oe<=Re){const X=ae.length>0&&E===ae[ae.length-1].ref.current;i.style.bottom="0px";const ie=m.clientHeight-b.offsetTop-b.offsetHeight,Pe=Math.max(et,Be+(X?ut:0)+ie+Z),Me=oe+Pe;i.style.height=Me+"px"}else{const X=ae.length>0&&E===ae[0].ref.current;i.style.top="0px";const Pe=Math.max(Re,K+b.offsetTop+(X?Qe:0)+Be)+pe;i.style.height=Pe+"px",b.scrollTop=oe-Re+b.offsetTop}i.style.margin=`${ke}px 0`,i.style.minHeight=Ee+"px",i.style.maxHeight=R+"px",n?.(),requestAnimationFrame(()=>x.current=!0)}},[C,o.trigger,o.valueNode,i,m,b,E,w,o.dir,n]);$e(()=>p(),[p]);const[j,k]=u.useState();$e(()=>{m&&k(window.getComputedStyle(m).zIndex)},[m]);const B=u.useCallback(P=>{P&&_.current===!0&&(p(),v?.(),_.current=!1)},[p,v]);return e.jsx(Il,{scope:s,contentWrapper:i,shouldExpandOnScrollRef:x,onScrollButtonChange:B,children:e.jsx("div",{ref:d,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:j},children:e.jsx(ye.div,{...a,ref:y,style:{boxSizing:"border-box",maxHeight:"100%",...a.style}})})})});dn.displayName=Tl;var kl="SelectPopperPosition",xs=u.forwardRef((t,r)=>{const{__scopeSelect:s,align:n="start",collisionPadding:a=ke,...o}=t,l=ss(s);return e.jsx(ro,{...l,...o,ref:r,align:n,collisionPadding:a,style:{boxSizing:"border-box",...o.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});xs.displayName=kl;var[Il,Rs]=dt(Xe,{}),gs="SelectViewport",un=u.forwardRef((t,r)=>{const{__scopeSelect:s,nonce:n,...a}=t,o=qe(gs,s),l=Rs(gs,s),i=je(r,o.onViewportChange),d=u.useRef(0);return e.jsxs(e.Fragment,{children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:n}),e.jsx(es.Slot,{scope:s,children:e.jsx(ye.div,{"data-radix-select-viewport":"",role:"presentation",...a,ref:i,style:{position:"relative",flex:1,overflow:"hidden auto",...a.style},onScroll:fe(a.onScroll,m=>{const h=m.currentTarget,{contentWrapper:y,shouldExpandOnScrollRef:C}=l;if(C?.current&&y){const x=Math.abs(d.current-h.scrollTop);if(x>0){const _=window.innerHeight-ke*2,b=parseFloat(y.style.minHeight),E=parseFloat(y.style.height),w=Math.max(b,E);if(w<_){const v=w+x,p=Math.min(_,v),j=v-p;y.style.height=p+"px",y.style.bottom==="0px"&&(h.scrollTop=j>0?j:0,y.style.justifyContent="flex-end")}}}d.current=h.scrollTop})})})]})});un.displayName=gs;var mn="SelectGroup",[Al,Pl]=dt(mn),Dl=u.forwardRef((t,r)=>{const{__scopeSelect:s,...n}=t,a=Ts();return e.jsx(Al,{scope:s,id:a,children:e.jsx(ye.div,{role:"group","aria-labelledby":a,...n,ref:r})})});Dl.displayName=mn;var fn="SelectLabel",Rl=u.forwardRef((t,r)=>{const{__scopeSelect:s,...n}=t,a=Pl(fn,s);return e.jsx(ye.div,{id:a.id,...n,ref:r})});Rl.displayName=fn;var Ft="SelectItem",[Ml,hn]=dt(Ft),pn=u.forwardRef((t,r)=>{const{__scopeSelect:s,value:n,disabled:a=!1,textValue:o,...l}=t,i=We(Ft,s),d=qe(Ft,s),m=i.value===n,[h,y]=u.useState(o??""),[C,x]=u.useState(!1),_=je(r,v=>d.itemRefCallback?.(v,n,a)),b=Ts(),E=u.useRef("touch"),w=()=>{a||(i.onValueChange(n),i.onOpenChange(!1))};if(n==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return e.jsx(Ml,{scope:s,value:n,disabled:a,textId:b,isSelected:m,onItemTextChange:u.useCallback(v=>{y(p=>p||(v?.textContent??"").trim())},[]),children:e.jsx(es.ItemSlot,{scope:s,value:n,disabled:a,textValue:h,children:e.jsx(ye.div,{role:"option","aria-labelledby":b,"data-highlighted":C?"":void 0,"aria-selected":m&&C,"data-state":m?"checked":"unchecked","aria-disabled":a||void 0,"data-disabled":a?"":void 0,tabIndex:a?void 0:-1,...l,ref:_,onFocus:fe(l.onFocus,()=>x(!0)),onBlur:fe(l.onBlur,()=>x(!1)),onClick:fe(l.onClick,()=>{E.current!=="mouse"&&w()}),onPointerUp:fe(l.onPointerUp,()=>{E.current==="mouse"&&w()}),onPointerDown:fe(l.onPointerDown,v=>{E.current=v.pointerType}),onPointerMove:fe(l.onPointerMove,v=>{E.current=v.pointerType,a?d.onItemLeave?.():E.current==="mouse"&&v.currentTarget.focus({preventScroll:!0})}),onPointerLeave:fe(l.onPointerLeave,v=>{v.currentTarget===document.activeElement&&d.onItemLeave?.()}),onKeyDown:fe(l.onKeyDown,v=>{d.searchRef?.current!==""&&v.key===" "||(yl.includes(v.key)&&w(),v.key===" "&&v.preventDefault())})})})})});pn.displayName=Ft;var ht="SelectItemText",xn=u.forwardRef((t,r)=>{const{__scopeSelect:s,className:n,style:a,...o}=t,l=We(ht,s),i=qe(ht,s),d=hn(ht,s),m=Sl(ht,s),[h,y]=u.useState(null),C=je(r,w=>y(w),d.onItemTextChange,w=>i.itemTextRefCallback?.(w,d.value,d.disabled)),x=h?.textContent,_=u.useMemo(()=>e.jsx("option",{value:d.value,disabled:d.disabled,children:x},d.value),[d.disabled,d.value,x]),{onNativeOptionAdd:b,onNativeOptionRemove:E}=m;return $e(()=>(b(_),()=>E(_)),[b,E,_]),e.jsxs(e.Fragment,{children:[e.jsx(ye.span,{id:d.textId,...o,ref:C}),d.isSelected&&l.valueNode&&!l.valueNodeHasChildren?jr.createPortal(o.children,l.valueNode):null]})});xn.displayName=ht;var gn="SelectItemIndicator",vn=u.forwardRef((t,r)=>{const{__scopeSelect:s,...n}=t;return hn(gn,s).isSelected?e.jsx(ye.span,{"aria-hidden":!0,...n,ref:r}):null});vn.displayName=gn;var vs="SelectScrollUpButton",yn=u.forwardRef((t,r)=>{const s=qe(vs,t.__scopeSelect),n=Rs(vs,t.__scopeSelect),[a,o]=u.useState(!1),l=je(r,n.onScrollButtonChange);return $e(()=>{if(s.viewport&&s.isPositioned){let i=function(){const m=d.scrollTop>0;o(m)};const d=s.viewport;return i(),d.addEventListener("scroll",i),()=>d.removeEventListener("scroll",i)}},[s.viewport,s.isPositioned]),a?e.jsx(jn,{...t,ref:l,onAutoScroll:()=>{const{viewport:i,selectedItem:d}=s;i&&d&&(i.scrollTop=i.scrollTop-d.offsetHeight)}}):null});yn.displayName=vs;var ys="SelectScrollDownButton",bn=u.forwardRef((t,r)=>{const s=qe(ys,t.__scopeSelect),n=Rs(ys,t.__scopeSelect),[a,o]=u.useState(!1),l=je(r,n.onScrollButtonChange);return $e(()=>{if(s.viewport&&s.isPositioned){let i=function(){const m=d.scrollHeight-d.clientHeight,h=Math.ceil(d.scrollTop)<m;o(h)};const d=s.viewport;return i(),d.addEventListener("scroll",i),()=>d.removeEventListener("scroll",i)}},[s.viewport,s.isPositioned]),a?e.jsx(jn,{...t,ref:l,onAutoScroll:()=>{const{viewport:i,selectedItem:d}=s;i&&d&&(i.scrollTop=i.scrollTop+d.offsetHeight)}}):null});bn.displayName=ys;var jn=u.forwardRef((t,r)=>{const{__scopeSelect:s,onAutoScroll:n,...a}=t,o=qe("SelectScrollButton",s),l=u.useRef(null),i=ts(s),d=u.useCallback(()=>{l.current!==null&&(window.clearInterval(l.current),l.current=null)},[]);return u.useEffect(()=>()=>d(),[d]),$e(()=>{i().find(h=>h.ref.current===document.activeElement)?.ref.current?.scrollIntoView({block:"nearest"})},[i]),e.jsx(ye.div,{"aria-hidden":!0,...a,ref:r,style:{flexShrink:0,...a.style},onPointerDown:fe(a.onPointerDown,()=>{l.current===null&&(l.current=window.setInterval(n,50))}),onPointerMove:fe(a.onPointerMove,()=>{o.onItemLeave?.(),l.current===null&&(l.current=window.setInterval(n,50))}),onPointerLeave:fe(a.onPointerLeave,()=>{d()})})}),Ll="SelectSeparator",Ol=u.forwardRef((t,r)=>{const{__scopeSelect:s,...n}=t;return e.jsx(ye.div,{"aria-hidden":!0,...n,ref:r})});Ol.displayName=Ll;var bs="SelectArrow",Ul=u.forwardRef((t,r)=>{const{__scopeSelect:s,...n}=t,a=ss(s),o=We(bs,s),l=qe(bs,s);return o.open&&l.position==="popper"?e.jsx(no,{...a,...n,ref:r}):null});Ul.displayName=bs;var Fl="SelectBubbleInput",wn=u.forwardRef(({__scopeSelect:t,value:r,...s},n)=>{const a=u.useRef(null),o=je(n,a),l=Ar(r);return u.useEffect(()=>{const i=a.current;if(!i)return;const d=window.HTMLSelectElement.prototype,h=Object.getOwnPropertyDescriptor(d,"value").set;if(l!==r&&h){const y=new Event("change",{bubbles:!0});h.call(i,r),i.dispatchEvent(y)}},[l,r]),e.jsx(ye.select,{...s,style:{...so,...s.style},ref:o,defaultValue:r})});wn.displayName=Fl;function Sn(t){return t===""||t===void 0}function Nn(t){const r=ha(t),s=u.useRef(""),n=u.useRef(0),a=u.useCallback(l=>{const i=s.current+l;r(i),(function d(m){s.current=m,window.clearTimeout(n.current),m!==""&&(n.current=window.setTimeout(()=>d(""),1e3))})(i)},[r]),o=u.useCallback(()=>{s.current="",window.clearTimeout(n.current)},[]);return u.useEffect(()=>()=>window.clearTimeout(n.current),[]),[s,a,o]}function Cn(t,r,s){const a=r.length>1&&Array.from(r).every(m=>m===r[0])?r[0]:r,o=s?t.indexOf(s):-1;let l=Vl(t,Math.max(o,0));a.length===1&&(l=l.filter(m=>m!==s));const d=l.find(m=>m.textValue.toLowerCase().startsWith(a.toLowerCase()));return d!==s?d:void 0}function Vl(t,r){return t.map((s,n)=>t[(r+n)%t.length])}var Bl=Qr,zl=tn,Hl=rn,$l=nn,Kl=an,Wl=on,ql=un,Gl=pn,Jl=xn,Yl=vn,Zl=yn,Xl=bn;function Vt({...t}){return e.jsx(Bl,{"data-slot":"select",...t})}function Bt({...t}){return e.jsx(Hl,{"data-slot":"select-value",...t})}function zt({className:t,size:r="default",children:s,...n}){return e.jsxs(zl,{"data-slot":"select-trigger","data-size":r,className:q("flex w-fit items-center justify-between gap-2 whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-xs outline-none transition-[color,box-shadow] focus-visible:border-ring focus-visible:ring-[3px] focus-visible:ring-ring/50 disabled:cursor-not-allowed disabled:opacity-50 aria-invalid:border-destructive aria-invalid:ring-destructive/20 data-[size=default]:h-9 data-[size=sm]:h-8 data-[placeholder]:text-muted-foreground *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 dark:bg-input/30 dark:aria-invalid:ring-destructive/40 dark:hover:bg-input/50 [&_svg:not([class*='size-'])]:size-4 [&_svg:not([class*='text-'])]:text-muted-foreground [&_svg]:pointer-events-none [&_svg]:shrink-0",t),...n,children:[s,e.jsx($l,{asChild:!0,children:e.jsx(ct,{className:"size-4 opacity-50"})})]})}function Ht({className:t,children:r,position:s="popper",align:n="center",...a}){return e.jsx(Kl,{children:e.jsxs(Wl,{"data-slot":"select-content",className:q("data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=closed]:animate-out data-[state=open]:animate-in",s==="popper"&&"data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=bottom]:translate-y-1 data-[side=top]:-translate-y-1",t),position:s,align:n,...a,children:[e.jsx(Ql,{}),e.jsx(ql,{className:q("p-1",s==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:r}),e.jsx(ei,{})]})})}function ot({className:t,children:r,...s}){return e.jsxs(Gl,{"data-slot":"select-item",className:q("relative flex w-full cursor-default select-none items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg:not([class*='size-'])]:size-4 [&_svg:not([class*='text-'])]:text-muted-foreground [&_svg]:pointer-events-none [&_svg]:shrink-0 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",t),...s,children:[e.jsx("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:e.jsx(Yl,{children:e.jsx(qt,{className:"size-4"})})}),e.jsx(Jl,{children:r})]})}function Ql({className:t,...r}){return e.jsx(Zl,{"data-slot":"select-scroll-up-button",className:q("flex cursor-default items-center justify-center py-1",t),...r,children:e.jsx(ko,{className:"size-4"})})}function ei({className:t,...r}){return e.jsx(Xl,{"data-slot":"select-scroll-down-button",className:q("flex cursor-default items-center justify-center py-1",t),...r,children:e.jsx(ct,{className:"size-4"})})}const ti=({providers:t,defaultProviderId:r,onDefaultProviderChange:s,onAddProvider:n})=>e.jsx("div",{className:"rounded-xl border border-border bg-card p-6 shadow-sm transition-all hover:shadow-md",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"flex h-12 w-12 shrink-0 items-center justify-center rounded-xl bg-[var(--accent-orange)]/10",children:e.jsx("img",{src:ja,alt:"BrowserOS",className:"h-8 w-8"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"mb-1 font-semibold text-xl",children:"LLM Providers"}),e.jsx("p",{className:"mb-6 text-muted-foreground text-sm",children:"Add your provider and choose the default LLM"}),e.jsxs("div",{className:"flex flex-col items-start gap-4 sm:flex-row sm:items-center",children:[e.jsx("label",{htmlFor:"provider-picker",className:"whitespace-nowrap font-medium text-sm",children:"Default Provider:"}),e.jsxs(Vt,{value:r,onValueChange:s,children:[e.jsx(zt,{id:"provider-picker",className:"w-full flex-1 sm:max-w-xs",children:e.jsx(Bt,{placeholder:"Select a provider"})}),e.jsx(Ht,{children:t.map(a=>e.jsx(ot,{value:a.id,children:a.name},a.id))})]}),e.jsxs(V,{variant:"outline",onClick:n,className:"border-[var(--accent-orange)] bg-[var(--accent-orange)]/10 text-[var(--accent-orange)] hover:bg-[var(--accent-orange)]/20 hover:text-[var(--accent-orange)]",children:[e.jsx(Ke,{className:"h-4 w-4"}),"Add custom provider"]})]})]})]})});var Pt=t=>t.type==="checkbox",Je=t=>t instanceof Date,be=t=>t==null;const _n=t=>typeof t=="object";var ue=t=>!be(t)&&!Array.isArray(t)&&_n(t)&&!Je(t),En=t=>ue(t)&&t.target?Pt(t.target)?t.target.checked:t.target.value:t,si=t=>t.substring(0,t.search(/\.\d+(\.|$)/))||t,Tn=(t,r)=>t.has(si(r)),ri=t=>{const r=t.constructor&&t.constructor.prototype;return ue(r)&&r.hasOwnProperty("isPrototypeOf")},Ms=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function me(t){if(t instanceof Date)return new Date(t);const r=typeof FileList<"u"&&t instanceof FileList;if(Ms&&(t instanceof Blob||r))return t;const s=Array.isArray(t);if(!s&&!(ue(t)&&ri(t)))return t;const n=s?[]:Object.create(Object.getPrototypeOf(t));for(const a in t)Object.prototype.hasOwnProperty.call(t,a)&&(n[a]=me(t[a]));return n}var rs=t=>/^\w*$/.test(t),le=t=>t===void 0,Ls=t=>Array.isArray(t)?t.filter(Boolean):[],Os=t=>Ls(t.replace(/["|']|\]/g,"").split(/\.|\[/)),I=(t,r,s)=>{if(!r||!ue(t))return s;const n=(rs(r)?[r]:Os(r)).reduce((a,o)=>be(a)?a:a[o],t);return le(n)||n===t?le(t[r])?s:t[r]:n},we=t=>typeof t=="boolean",ge=t=>typeof t=="function",$=(t,r,s)=>{let n=-1;const a=rs(r)?[r]:Os(r),o=a.length,l=o-1;for(;++n<o;){const i=a[n];let d=s;if(n!==l){const m=t[i];d=ue(m)||Array.isArray(m)?m:isNaN(+a[n+1])?{}:[]}if(i==="__proto__"||i==="constructor"||i==="prototype")return;t[i]=d,t=t[i]}};const $t={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},Ie={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},Le={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},Us=L.createContext(null);Us.displayName="HookFormContext";const ns=()=>L.useContext(Us),ni=t=>{const{children:r,...s}=t;return L.createElement(Us.Provider,{value:s},r)};var kn=(t,r,s,n=!0)=>{const a={defaultValues:r._defaultValues};for(const o in t)Object.defineProperty(a,o,{get:()=>{const l=o;return r._proxyFormState[l]!==Ie.all&&(r._proxyFormState[l]=!n||Ie.all),s&&(s[l]=!0),t[l]}});return a};const Fs=typeof window<"u"?L.useLayoutEffect:L.useEffect;function In(t){const r=ns(),{control:s=r.control,disabled:n,name:a,exact:o}=t||{},[l,i]=L.useState(s._formState),d=L.useRef({isDirty:!1,isLoading:!1,dirtyFields:!1,touchedFields:!1,validatingFields:!1,isValidating:!1,isValid:!1,errors:!1});return Fs(()=>s._subscribe({name:a,formState:d.current,exact:o,callback:m=>{!n&&i({...s._formState,...m})}}),[a,n,o]),L.useEffect(()=>{d.current.isValid&&s._setValid(!0)},[s]),L.useMemo(()=>kn(l,s,d.current,!1),[l,s])}var Ne=t=>typeof t=="string",js=(t,r,s,n,a)=>Ne(t)?(n&&r.watch.add(t),I(s,t,a)):Array.isArray(t)?t.map(o=>(n&&r.watch.add(o),I(s,o))):(n&&(r.watchAll=!0),s),ws=t=>be(t)||!_n(t);function Ae(t,r,s=new WeakSet){if(ws(t)||ws(r))return Object.is(t,r);if(Je(t)&&Je(r))return t.getTime()===r.getTime();const n=Object.keys(t),a=Object.keys(r);if(n.length!==a.length)return!1;if(s.has(t)||s.has(r))return!0;s.add(t),s.add(r);for(const o of n){const l=t[o];if(!a.includes(o))return!1;if(o!=="ref"){const i=r[o];if(Je(l)&&Je(i)||ue(l)&&ue(i)||Array.isArray(l)&&Array.isArray(i)?!Ae(l,i,s):!Object.is(l,i))return!1}}return!0}function ai(t){const r=ns(),{control:s=r.control,name:n,defaultValue:a,disabled:o,exact:l,compute:i}=t||{},d=L.useRef(a),m=L.useRef(i),h=L.useRef(void 0),y=L.useRef(s),C=L.useRef(n);m.current=i;const[x,_]=L.useState(()=>{const j=s._getWatch(n,d.current);return m.current?m.current(j):j}),b=L.useCallback(j=>{const k=js(n,s._names,j||s._formValues,!1,d.current);return m.current?m.current(k):k},[s._formValues,s._names,n]),E=L.useCallback(j=>{if(!o){const k=js(n,s._names,j||s._formValues,!1,d.current);if(m.current){const B=m.current(k);Ae(B,h.current)||(_(B),h.current=B)}else _(k)}},[s._formValues,s._names,o,n]);Fs(()=>((y.current!==s||!Ae(C.current,n))&&(y.current=s,C.current=n,E()),s._subscribe({name:n,formState:{values:!0},exact:l,callback:j=>{E(j.values)}})),[s,l,n,E]),L.useEffect(()=>s._removeUnmounted());const w=y.current!==s,v=C.current,p=L.useMemo(()=>{if(o)return null;const j=!w&&!Ae(v,n);return w||j?b():null},[o,w,n,v,b]);return p!==null?p:x}function oi(t){const r=ns(),{name:s,disabled:n,control:a=r.control,shouldUnregister:o,defaultValue:l,exact:i=!0}=t,d=Tn(a._names.array,s),m=L.useMemo(()=>I(a._formValues,s,I(a._defaultValues,s,l)),[a,s,l]),h=ai({control:a,name:s,defaultValue:m,exact:i}),y=In({control:a,name:s,exact:i}),C=L.useRef(t),x=L.useRef(void 0),_=L.useRef(a.register(s,{...t.rules,value:h,...we(t.disabled)?{disabled:t.disabled}:{}}));C.current=t;const b=L.useMemo(()=>Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!I(y.errors,s)},isDirty:{enumerable:!0,get:()=>!!I(y.dirtyFields,s)},isTouched:{enumerable:!0,get:()=>!!I(y.touchedFields,s)},isValidating:{enumerable:!0,get:()=>!!I(y.validatingFields,s)},error:{enumerable:!0,get:()=>I(y.errors,s)}}),[y,s]),E=L.useCallback(j=>_.current.onChange({target:{value:En(j),name:s},type:$t.CHANGE}),[s]),w=L.useCallback(()=>_.current.onBlur({target:{value:I(a._formValues,s),name:s},type:$t.BLUR}),[s,a._formValues]),v=L.useCallback(j=>{const k=I(a._fields,s);k&&k._f&&j&&(k._f.ref={focus:()=>ge(j.focus)&&j.focus(),select:()=>ge(j.select)&&j.select(),setCustomValidity:B=>ge(j.setCustomValidity)&&j.setCustomValidity(B),reportValidity:()=>ge(j.reportValidity)&&j.reportValidity()})},[a._fields,s]),p=L.useMemo(()=>({name:s,value:h,...we(n)||y.disabled?{disabled:y.disabled||n}:{},onChange:E,onBlur:w,ref:v}),[s,n,y.disabled,E,w,v,h]);return L.useEffect(()=>{const j=a._options.shouldUnregister||o,k=x.current;k&&k!==s&&!d&&a.unregister(k),a.register(s,{...C.current.rules,...we(C.current.disabled)?{disabled:C.current.disabled}:{}});const B=(P,Y)=>{const ne=I(a._fields,P);ne&&ne._f&&(ne._f.mount=Y)};if(B(s,!0),j){const P=me(I(a._options.defaultValues,s,C.current.defaultValue));$(a._defaultValues,s,P),le(I(a._formValues,s))&&$(a._formValues,s,P)}return!d&&a.register(s),x.current=s,()=>{(d?j&&!a._state.action:j)?a.unregister(s):B(s,!1)}},[s,a,d,o]),L.useEffect(()=>{a._setDisabledField({disabled:n,name:s})},[n,s,a]),L.useMemo(()=>({field:p,formState:y,fieldState:b}),[p,y,b])}const li=t=>t.render(oi(t));var Vs=(t,r,s,n,a)=>r?{...s[t],types:{...s[t]&&s[t].types?s[t].types:{},[n]:a||!0}}:{},xt=t=>Array.isArray(t)?t:[t],Gs=()=>{let t=[];return{get observers(){return t},next:a=>{for(const o of t)o.next&&o.next(a)},subscribe:a=>(t.push(a),{unsubscribe:()=>{t=t.filter(o=>o!==a)}}),unsubscribe:()=>{t=[]}}};function An(t,r){const s={};for(const n in t)if(t.hasOwnProperty(n)){const a=t[n],o=r[n];if(a&&ue(a)&&o){const l=An(a,o);ue(l)&&(s[n]=l)}else t[n]&&(s[n]=o)}return s}var xe=t=>ue(t)&&!Object.keys(t).length,Bs=t=>t.type==="file",Kt=t=>{if(!Ms)return!1;const r=t?t.ownerDocument:0;return t instanceof(r&&r.defaultView?r.defaultView.HTMLElement:HTMLElement)},Pn=t=>t.type==="select-multiple",zs=t=>t.type==="radio",ii=t=>zs(t)||Pt(t),fs=t=>Kt(t)&&t.isConnected;function ci(t,r){const s=r.slice(0,-1).length;let n=0;for(;n<s;)t=le(t)?n++:t[r[n++]];return t}function di(t){for(const r in t)if(t.hasOwnProperty(r)&&!le(t[r]))return!1;return!0}function ce(t,r){const s=Array.isArray(r)?r:rs(r)?[r]:Os(r),n=s.length===1?t:ci(t,s),a=s.length-1,o=s[a];return n&&delete n[o],a!==0&&(ue(n)&&xe(n)||Array.isArray(n)&&di(n))&&ce(t,s.slice(0,-1)),t}var ui=t=>{for(const r in t)if(ge(t[r]))return!0;return!1};function Dn(t){return Array.isArray(t)||ue(t)&&!ui(t)}function Ss(t,r={}){for(const s in t){const n=t[s];Dn(n)?(r[s]=Array.isArray(n)?[]:{},Ss(n,r[s])):le(n)||(r[s]=!0)}return r}function nt(t,r,s){s||(s=Ss(r));for(const n in t){const a=t[n];if(Dn(a))le(r)||ws(s[n])?s[n]=Ss(a,Array.isArray(a)?[]:{}):nt(a,be(r)?{}:r[n],s[n]);else{const o=r[n];s[n]=!Ae(a,o)}}return s}const Js={value:!1,isValid:!1},Ys={value:!0,isValid:!0};var Rn=t=>{if(Array.isArray(t)){if(t.length>1){const r=t.filter(s=>s&&s.checked&&!s.disabled).map(s=>s.value);return{value:r,isValid:!!r.length}}return t[0].checked&&!t[0].disabled?t[0].attributes&&!le(t[0].attributes.value)?le(t[0].value)||t[0].value===""?Ys:{value:t[0].value,isValid:!0}:Ys:Js}return Js},Mn=(t,{valueAsNumber:r,valueAsDate:s,setValueAs:n})=>le(t)?t:r?t===""?NaN:t&&+t:s&&Ne(t)?new Date(t):n?n(t):t;const Zs={isValid:!1,value:null};var Ln=t=>Array.isArray(t)?t.reduce((r,s)=>s&&s.checked&&!s.disabled?{isValid:!0,value:s.value}:r,Zs):Zs;function Xs(t){const r=t.ref;return Bs(r)?r.files:zs(r)?Ln(t.refs).value:Pn(r)?[...r.selectedOptions].map(({value:s})=>s):Pt(r)?Rn(t.refs).value:Mn(le(r.value)?t.ref.value:r.value,t)}var mi=(t,r,s,n)=>{const a={};for(const o of t){const l=I(r,o);l&&$(a,o,l._f)}return{criteriaMode:s,names:[...t],fields:a,shouldUseNativeValidation:n}},Wt=t=>t instanceof RegExp,ft=t=>le(t)?t:Wt(t)?t.source:ue(t)?Wt(t.value)?t.value.source:t.value:t,Qs=t=>({isOnSubmit:!t||t===Ie.onSubmit,isOnBlur:t===Ie.onBlur,isOnChange:t===Ie.onChange,isOnAll:t===Ie.all,isOnTouch:t===Ie.onTouched});const er="AsyncFunction";var fi=t=>!!t&&!!t.validate&&!!(ge(t.validate)&&t.validate.constructor.name===er||ue(t.validate)&&Object.values(t.validate).find(r=>r.constructor.name===er)),hi=t=>t.mount&&(t.required||t.min||t.max||t.maxLength||t.minLength||t.pattern||t.validate),tr=(t,r,s)=>!s&&(r.watchAll||r.watch.has(t)||[...r.watch].some(n=>t.startsWith(n)&&/^\.\w+/.test(t.slice(n.length))));const gt=(t,r,s,n)=>{for(const a of s||Object.keys(t)){const o=I(t,a);if(o){const{_f:l,...i}=o;if(l){if(l.refs&&l.refs[0]&&r(l.refs[0],a)&&!n)return!0;if(l.ref&&r(l.ref,l.name)&&!n)return!0;if(gt(i,r))break}else if(ue(i)&&gt(i,r))break}}};function sr(t,r,s){const n=I(t,s);if(n||rs(s))return{error:n,name:s};const a=s.split(".");for(;a.length;){const o=a.join("."),l=I(r,o),i=I(t,o);if(l&&!Array.isArray(l)&&s!==o)return{name:s};if(i&&i.type)return{name:o,error:i};if(i&&i.root&&i.root.type)return{name:`${o}.root`,error:i.root};a.pop()}return{name:s}}var pi=(t,r,s,n)=>{s(t);const{name:a,...o}=t;return xe(o)||Object.keys(o).length>=Object.keys(r).length||Object.keys(o).find(l=>r[l]===(!n||Ie.all))},xi=(t,r,s)=>!t||!r||t===r||xt(t).some(n=>n&&(s?n===r:n.startsWith(r)||r.startsWith(n))),gi=(t,r,s,n,a)=>a.isOnAll?!1:!s&&a.isOnTouch?!(r||t):(s?n.isOnBlur:a.isOnBlur)?!t:(s?n.isOnChange:a.isOnChange)?t:!0,vi=(t,r)=>!Ls(I(t,r)).length&&ce(t,r),yi=(t,r,s)=>{const n=xt(I(t,s));return $(n,"root",r[s]),$(t,s,n),t};function rr(t,r,s="validate"){if(Ne(t)||Array.isArray(t)&&t.every(Ne)||we(t)&&!t)return{type:s,message:Ne(t)?t:"",ref:r}}var rt=t=>ue(t)&&!Wt(t)?t:{value:t,message:""},nr=async(t,r,s,n,a,o)=>{const{ref:l,refs:i,required:d,maxLength:m,minLength:h,min:y,max:C,pattern:x,validate:_,name:b,valueAsNumber:E,mount:w}=t._f,v=I(s,b);if(!w||r.has(b))return{};const p=i?i[0]:l,j=R=>{a&&p.reportValidity&&(p.setCustomValidity(we(R)?"":R||""),p.reportValidity())},k={},B=zs(l),P=Pt(l),Y=B||P,ne=(E||Bs(l))&&le(l.value)&&le(v)||Kt(l)&&l.value===""||v===""||Array.isArray(v)&&!v.length,O=Vs.bind(null,b,n,k),ae=(R,U,z,K=Le.maxLength,W=Le.minLength)=>{const Z=R?U:z;k[b]={type:R?K:W,message:Z,ref:l,...O(R?K:W,Z)}};if(o?!Array.isArray(v)||!v.length:d&&(!Y&&(ne||be(v))||we(v)&&!v||P&&!Rn(i).isValid||B&&!Ln(i).isValid)){const{value:R,message:U}=Ne(d)?{value:!!d,message:d}:rt(d);if(R&&(k[b]={type:Le.required,message:U,ref:p,...O(Le.required,U)},!n))return j(U),k}if(!ne&&(!be(y)||!be(C))){let R,U;const z=rt(C),K=rt(y);if(!be(v)&&!isNaN(v)){const W=l.valueAsNumber||v&&+v;be(z.value)||(R=W>z.value),be(K.value)||(U=W<K.value)}else{const W=l.valueAsDate||new Date(v),Z=Ee=>new Date(new Date().toDateString()+" "+Ee),S=l.type=="time",F=l.type=="week";Ne(z.value)&&v&&(R=S?Z(v)>Z(z.value):F?v>z.value:W>new Date(z.value)),Ne(K.value)&&v&&(U=S?Z(v)<Z(K.value):F?v<K.value:W<new Date(K.value))}if((R||U)&&(ae(!!R,z.message,K.message,Le.max,Le.min),!n))return j(k[b].message),k}if((m||h)&&!ne&&(Ne(v)||o&&Array.isArray(v))){const R=rt(m),U=rt(h),z=!be(R.value)&&v.length>+R.value,K=!be(U.value)&&v.length<+U.value;if((z||K)&&(ae(z,R.message,U.message),!n))return j(k[b].message),k}if(x&&!ne&&Ne(v)){const{value:R,message:U}=rt(x);if(Wt(R)&&!v.match(R)&&(k[b]={type:Le.pattern,message:U,ref:l,...O(Le.pattern,U)},!n))return j(U),k}if(_){if(ge(_)){const R=await _(v,s),U=rr(R,p);if(U&&(k[b]={...U,...O(Le.validate,U.message)},!n))return j(U.message),k}else if(ue(_)){let R={};for(const U in _){if(!xe(R)&&!n)break;const z=rr(await _[U](v,s),p,U);z&&(R={...z,...O(U,z.message)},j(z.message),n&&(k[b]=R))}if(!xe(R)&&(k[b]={ref:p,...R},!n))return k}}return j(!0),k};const bi={mode:Ie.onSubmit,reValidateMode:Ie.onChange,shouldFocusError:!0};function ji(t={}){let r={...bi,...t},s={submitCount:0,isDirty:!1,isReady:!1,isLoading:ge(r.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:r.errors||{},disabled:r.disabled||!1},n={},a=ue(r.defaultValues)||ue(r.values)?me(r.defaultValues||r.values)||{}:{},o=r.shouldUnregister?{}:me(a),l={action:!1,mount:!1,watch:!1,keepIsValid:!1},i={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},d,m=0;const h={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1},y={...h};let C={...y};const x={array:Gs(),state:Gs()},_=r.criteriaMode===Ie.all,b=c=>f=>{clearTimeout(m),m=setTimeout(c,f)},E=async c=>{if(!l.keepIsValid&&!r.disabled&&(y.isValid||C.isValid||c)){let f;r.resolver?(f=xe((await Y()).errors),w()):f=await O(n,!0),f!==s.isValid&&x.state.next({isValid:f})}},w=(c,f)=>{!r.disabled&&(y.isValidating||y.validatingFields||C.isValidating||C.validatingFields)&&((c||Array.from(i.mount)).forEach(g=>{g&&(f?$(s.validatingFields,g,f):ce(s.validatingFields,g))}),x.state.next({validatingFields:s.validatingFields,isValidating:!xe(s.validatingFields)}))},v=(c,f=[],g,A,T=!0,N=!0)=>{if(A&&g&&!r.disabled){if(l.action=!0,N&&Array.isArray(I(n,c))){const D=g(I(n,c),A.argA,A.argB);T&&$(n,c,D)}if(N&&Array.isArray(I(s.errors,c))){const D=g(I(s.errors,c),A.argA,A.argB);T&&$(s.errors,c,D),vi(s.errors,c)}if((y.touchedFields||C.touchedFields)&&N&&Array.isArray(I(s.touchedFields,c))){const D=g(I(s.touchedFields,c),A.argA,A.argB);T&&$(s.touchedFields,c,D)}(y.dirtyFields||C.dirtyFields)&&(s.dirtyFields=nt(a,o)),x.state.next({name:c,isDirty:R(c,f),dirtyFields:s.dirtyFields,errors:s.errors,isValid:s.isValid})}else $(o,c,f)},p=(c,f)=>{$(s.errors,c,f),x.state.next({errors:s.errors})},j=c=>{s.errors=c,x.state.next({errors:s.errors,isValid:!1})},k=(c,f,g,A)=>{const T=I(n,c);if(T){const N=I(o,c,le(g)?I(a,c):g);le(N)||A&&A.defaultChecked||f?$(o,c,f?N:Xs(T._f)):K(c,N),l.mount&&!l.action&&E()}},B=(c,f,g,A,T)=>{let N=!1,D=!1;const H={name:c};if(!r.disabled){if(!g||A){(y.isDirty||C.isDirty)&&(D=s.isDirty,s.isDirty=H.isDirty=R(),N=D!==H.isDirty);const Q=Ae(I(a,c),f);D=!!I(s.dirtyFields,c),Q?ce(s.dirtyFields,c):$(s.dirtyFields,c,!0),H.dirtyFields=s.dirtyFields,N=N||(y.dirtyFields||C.dirtyFields)&&D!==!Q}if(g){const Q=I(s.touchedFields,c);Q||($(s.touchedFields,c,g),H.touchedFields=s.touchedFields,N=N||(y.touchedFields||C.touchedFields)&&Q!==g)}N&&T&&x.state.next(H)}return N?H:{}},P=(c,f,g,A)=>{const T=I(s.errors,c),N=(y.isValid||C.isValid)&&we(f)&&s.isValid!==f;if(r.delayError&&g?(d=b(()=>p(c,g)),d(r.delayError)):(clearTimeout(m),d=null,g?$(s.errors,c,g):ce(s.errors,c)),(g?!Ae(T,g):T)||!xe(A)||N){const D={...A,...N&&we(f)?{isValid:f}:{},errors:s.errors,name:c};s={...s,...D},x.state.next(D)}},Y=async c=>(w(c,!0),await r.resolver(o,r.context,mi(c||i.mount,n,r.criteriaMode,r.shouldUseNativeValidation))),ne=async c=>{const{errors:f}=await Y(c);if(w(c),c)for(const g of c){const A=I(f,g);A?$(s.errors,g,A):ce(s.errors,g)}else s.errors=f;return f},O=async(c,f,g={valid:!0})=>{for(const A in c){const T=c[A];if(T){const{_f:N,...D}=T;if(N){const H=i.array.has(N.name),Q=T._f&&fi(T._f);Q&&y.validatingFields&&w([N.name],!0);const Ce=await nr(T,i.disabled,o,_,r.shouldUseNativeValidation&&!f,H);if(Q&&y.validatingFields&&w([N.name]),Ce[N.name]&&(g.valid=!1,f))break;!f&&(I(Ce,N.name)?H?yi(s.errors,Ce,N.name):$(s.errors,N.name,Ce[N.name]):ce(s.errors,N.name))}!xe(D)&&await O(D,f,g)}}return g.valid},ae=()=>{for(const c of i.unMount){const f=I(n,c);f&&(f._f.refs?f._f.refs.every(g=>!fs(g)):!fs(f._f.ref))&&oe(c)}i.unMount=new Set},R=(c,f)=>!r.disabled&&(c&&f&&$(o,c,f),!Ae(Ge(),a)),U=(c,f,g)=>js(c,i,{...l.mount?o:le(f)?a:Ne(c)?{[c]:f}:f},g,f),z=c=>Ls(I(l.mount?o:a,c,r.shouldUnregister?I(a,c,[]):[])),K=(c,f,g={})=>{const A=I(n,c);let T=f;if(A){const N=A._f;N&&(!N.disabled&&$(o,c,Mn(f,N)),T=Kt(N.ref)&&be(f)?"":f,Pn(N.ref)?[...N.ref.options].forEach(D=>D.selected=T.includes(D.value)):N.refs?Pt(N.ref)?N.refs.forEach(D=>{(!D.defaultChecked||!D.disabled)&&(Array.isArray(T)?D.checked=!!T.find(H=>H===D.value):D.checked=T===D.value||!!T)}):N.refs.forEach(D=>D.checked=D.value===T):Bs(N.ref)?N.ref.value="":(N.ref.value=T,N.ref.type||x.state.next({name:c,values:me(o)})))}(g.shouldDirty||g.shouldTouch)&&B(c,T,g.shouldTouch,g.shouldDirty,!0),g.shouldValidate&&Ee(c)},W=(c,f,g)=>{for(const A in f){if(!f.hasOwnProperty(A))return;const T=f[A],N=c+"."+A,D=I(n,N);(i.array.has(c)||ue(T)||D&&!D._f)&&!Je(T)?W(N,T,g):K(N,T,g)}},Z=(c,f,g={})=>{const A=I(n,c),T=i.array.has(c),N=me(f);$(o,c,N),T?(x.array.next({name:c,values:me(o)}),(y.isDirty||y.dirtyFields||C.isDirty||C.dirtyFields)&&g.shouldDirty&&x.state.next({name:c,dirtyFields:nt(a,o),isDirty:R(c,N)})):A&&!A._f&&!be(N)?W(c,N,g):K(c,N,g),tr(c,i)&&x.state.next({...s,name:c}),x.state.next({name:l.mount?c:void 0,values:me(o)})},S=async c=>{l.mount=!0;const f=c.target;let g=f.name,A=!0;const T=I(n,g),N=Q=>{A=Number.isNaN(Q)||Je(Q)&&isNaN(Q.getTime())||Ae(Q,I(o,g,Q))},D=Qs(r.mode),H=Qs(r.reValidateMode);if(T){let Q,Ce;const Dt=f.type?Xs(T._f):En(c),ze=c.type===$t.BLUR||c.type===$t.FOCUS_OUT,ta=!hi(T._f)&&!r.resolver&&!I(s.errors,g)&&!T._f.deps||gi(ze,I(s.touchedFields,g),s.isSubmitted,H,D),ds=tr(g,i,ze);$(o,g,Dt),ze?(!f||!f.readOnly)&&(T._f.onBlur&&T._f.onBlur(c),d&&d(0)):T._f.onChange&&T._f.onChange(c);const us=B(g,Dt,ze),sa=!xe(us)||ds;if(!ze&&x.state.next({name:g,type:c.type,values:me(o)}),ta)return(y.isValid||C.isValid)&&(r.mode==="onBlur"?ze&&E():ze||E()),sa&&x.state.next({name:g,...ds?{}:us});if(!ze&&ds&&x.state.next({...s}),r.resolver){const{errors:$s}=await Y([g]);if(w([g]),N(Dt),A){const ra=sr(s.errors,n,g),Ks=sr($s,n,ra.name||g);Q=Ks.error,g=Ks.name,Ce=xe($s)}}else w([g],!0),Q=(await nr(T,i.disabled,o,_,r.shouldUseNativeValidation))[g],w([g]),N(Dt),A&&(Q?Ce=!1:(y.isValid||C.isValid)&&(Ce=await O(n,!0)));A&&(T._f.deps&&(!Array.isArray(T._f.deps)||T._f.deps.length>0)&&Ee(T._f.deps),P(g,Ce,Q,us))}},F=(c,f)=>{if(I(s.errors,f)&&c.focus)return c.focus(),1},Ee=async(c,f={})=>{let g,A;const T=xt(c);if(r.resolver){const N=await ne(le(c)?c:T);g=xe(N),A=c?!T.some(D=>I(N,D)):g}else c?(A=(await Promise.all(T.map(async N=>{const D=I(n,N);return await O(D&&D._f?{[N]:D}:D)}))).every(Boolean),!(!A&&!s.isValid)&&E()):A=g=await O(n);return x.state.next({...!Ne(c)||(y.isValid||C.isValid)&&g!==s.isValid?{}:{name:c},...r.resolver||!c?{isValid:g}:{},errors:s.errors}),f.shouldFocus&&!A&&gt(n,F,c?T:i.mount),A},Ge=(c,f)=>{let g={...l.mount?o:a};return f&&(g=An(f.dirtyFields?s.dirtyFields:s.touchedFields,g)),le(c)?g:Ne(c)?I(g,c):c.map(A=>I(g,A))},Qe=(c,f)=>({invalid:!!I((f||s).errors,c),isDirty:!!I((f||s).dirtyFields,c),error:I((f||s).errors,c),isValidating:!!I(s.validatingFields,c),isTouched:!!I((f||s).touchedFields,c)}),ut=c=>{c&&xt(c).forEach(f=>ce(s.errors,f)),x.state.next({errors:c?s.errors:{}})},Re=(c,f,g)=>{const A=(I(n,c,{_f:{}})._f||{}).ref,T=I(s.errors,c)||{},{ref:N,message:D,type:H,...Q}=T;$(s.errors,c,{...Q,...f,ref:A}),x.state.next({name:c,errors:s.errors,isValid:!1}),g&&g.shouldFocus&&A&&A.focus&&A.focus()},et=(c,f)=>ge(c)?x.state.subscribe({next:g=>"values"in g&&c(U(void 0,f),g)}):U(c,f,!0),Be=c=>x.state.subscribe({next:f=>{xi(c.name,f.name,c.exact)&&pi(f,c.formState||y,ea,c.reRenderRoot)&&c.callback({values:{...o},...s,...f,defaultValues:a})}}).unsubscribe,M=c=>(l.mount=!0,C={...C,...c.formState},Be({...c,formState:{...h,...c.formState}})),oe=(c,f={})=>{for(const g of c?xt(c):i.mount)i.mount.delete(g),i.array.delete(g),f.keepValue||(ce(n,g),ce(o,g)),!f.keepError&&ce(s.errors,g),!f.keepDirty&&ce(s.dirtyFields,g),!f.keepTouched&&ce(s.touchedFields,g),!f.keepIsValidating&&ce(s.validatingFields,g),!r.shouldUnregister&&!f.keepDefaultValue&&ce(a,g);x.state.next({values:me(o)}),x.state.next({...s,...f.keepDirty?{isDirty:R()}:{}}),!f.keepIsValid&&E()},pe=({disabled:c,name:f})=>{(we(c)&&l.mount||c||i.disabled.has(f))&&(c?i.disabled.add(f):i.disabled.delete(f))},G=(c,f={})=>{let g=I(n,c);const A=we(f.disabled)||we(r.disabled);return $(n,c,{...g||{},_f:{...g&&g._f?g._f:{ref:{name:c}},name:c,mount:!0,...f}}),i.mount.add(c),g?pe({disabled:we(f.disabled)?f.disabled:r.disabled,name:c}):k(c,!0,f.value),{...A?{disabled:f.disabled||r.disabled}:{},...r.progressive?{required:!!f.required,min:ft(f.min),max:ft(f.max),minLength:ft(f.minLength),maxLength:ft(f.maxLength),pattern:ft(f.pattern)}:{},name:c,onChange:S,onBlur:S,ref:T=>{if(T){G(c,f),g=I(n,c);const N=le(T.value)&&T.querySelectorAll&&T.querySelectorAll("input,select,textarea")[0]||T,D=ii(N),H=g._f.refs||[];if(D?H.find(Q=>Q===N):N===g._f.ref)return;$(n,c,{_f:{...g._f,...D?{refs:[...H.filter(fs),N,...Array.isArray(I(a,c))?[{}]:[]],ref:{type:N.type,name:c}}:{ref:N}}}),k(c,!1,void 0,N)}else g=I(n,c,{}),g._f&&(g._f.mount=!1),(r.shouldUnregister||f.shouldUnregister)&&!(Tn(i.array,c)&&l.action)&&i.unMount.add(c)}}},X=()=>r.shouldFocusError&&gt(n,F,i.mount),ie=c=>{we(c)&&(x.state.next({disabled:c}),gt(n,(f,g)=>{const A=I(n,g);A&&(f.disabled=A._f.disabled||c,Array.isArray(A._f.refs)&&A._f.refs.forEach(T=>{T.disabled=A._f.disabled||c}))},0,!1))},Pe=(c,f)=>async g=>{let A;g&&(g.preventDefault&&g.preventDefault(),g.persist&&g.persist());let T=me(o);if(x.state.next({isSubmitting:!0}),r.resolver){const{errors:N,values:D}=await Y();w(),s.errors=N,T=me(D)}else await O(n);if(i.disabled.size)for(const N of i.disabled)ce(T,N);if(ce(s.errors,"root"),xe(s.errors)){x.state.next({errors:{}});try{await c(T,g)}catch(N){A=N}}else f&&await f({...s.errors},g),X(),setTimeout(X);if(x.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:xe(s.errors)&&!A,submitCount:s.submitCount+1,errors:s.errors}),A)throw A},Me=(c,f={})=>{I(n,c)&&(le(f.defaultValue)?Z(c,me(I(a,c))):(Z(c,f.defaultValue),$(a,c,me(f.defaultValue))),f.keepTouched||ce(s.touchedFields,c),f.keepDirty||(ce(s.dirtyFields,c),s.isDirty=f.defaultValue?R(c,me(I(a,c))):R()),f.keepError||(ce(s.errors,c),y.isValid&&E()),x.state.next({...s}))},tt=(c,f={})=>{const g=c?me(c):a,A=me(g),T=xe(c),N=T?a:A;if(f.keepDefaultValues||(a=g),!f.keepValues){if(f.keepDirtyValues){const D=new Set([...i.mount,...Object.keys(nt(a,o))]);for(const H of Array.from(D))I(s.dirtyFields,H)?$(N,H,I(o,H)):Z(H,I(N,H))}else{if(Ms&&le(c))for(const D of i.mount){const H=I(n,D);if(H&&H._f){const Q=Array.isArray(H._f.refs)?H._f.refs[0]:H._f.ref;if(Kt(Q)){const Ce=Q.closest("form");if(Ce){Ce.reset();break}}}}if(f.keepFieldsRef)for(const D of i.mount)Z(D,I(N,D));else n={}}o=r.shouldUnregister?f.keepDefaultValues?me(a):{}:me(N),x.array.next({values:{...N}}),x.state.next({values:{...N}})}i={mount:f.keepDirtyValues?i.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},l.mount=!y.isValid||!!f.keepIsValid||!!f.keepDirtyValues||!r.shouldUnregister&&!xe(N),l.watch=!!r.shouldUnregister,l.keepIsValid=!!f.keepIsValid,l.action=!1,f.keepErrors||(s.errors={}),x.state.next({submitCount:f.keepSubmitCount?s.submitCount:0,isDirty:T?!1:f.keepDirty?s.isDirty:!!(f.keepDefaultValues&&!Ae(c,a)),isSubmitted:f.keepIsSubmitted?s.isSubmitted:!1,dirtyFields:T?{}:f.keepDirtyValues?f.keepDefaultValues&&o?nt(a,o):s.dirtyFields:f.keepDefaultValues&&c?nt(a,c):f.keepDirty?s.dirtyFields:{},touchedFields:f.keepTouched?s.touchedFields:{},errors:f.keepErrors?s.errors:{},isSubmitSuccessful:f.keepIsSubmitSuccessful?s.isSubmitSuccessful:!1,isSubmitting:!1,defaultValues:a})},st=(c,f)=>tt(ge(c)?c(o):c,{...r.resetOptions,...f}),mt=(c,f={})=>{const g=I(n,c),A=g&&g._f;if(A){const T=A.refs?A.refs[0]:A.ref;T.focus&&setTimeout(()=>{T.focus(),f.shouldSelect&&ge(T.select)&&T.select()})}},ea=c=>{s={...s,...c}},Hs={control:{register:G,unregister:oe,getFieldState:Qe,handleSubmit:Pe,setError:Re,_subscribe:Be,_runSchema:Y,_updateIsValidating:w,_focusError:X,_getWatch:U,_getDirty:R,_setValid:E,_setFieldArray:v,_setDisabledField:pe,_setErrors:j,_getFieldArray:z,_reset:tt,_resetDefaultValues:()=>ge(r.defaultValues)&&r.defaultValues().then(c=>{st(c,r.resetOptions),x.state.next({isLoading:!1})}),_removeUnmounted:ae,_disableForm:ie,_subjects:x,_proxyFormState:y,get _fields(){return n},get _formValues(){return o},get _state(){return l},set _state(c){l=c},get _defaultValues(){return a},get _names(){return i},set _names(c){i=c},get _formState(){return s},get _options(){return r},set _options(c){r={...r,...c}}},subscribe:M,trigger:Ee,register:G,handleSubmit:Pe,watch:et,setValue:Z,getValues:Ge,reset:st,resetField:Me,clearErrors:ut,unregister:oe,setError:Re,setFocus:mt,getFieldState:Qe};return{...Hs,formControl:Hs}}function as(t={}){const r=L.useRef(void 0),s=L.useRef(void 0),[n,a]=L.useState({isDirty:!1,isValidating:!1,isLoading:ge(t.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:t.errors||{},disabled:t.disabled||!1,isReady:!1,defaultValues:ge(t.defaultValues)?void 0:t.defaultValues});if(!r.current)if(t.formControl)r.current={...t.formControl,formState:n},t.defaultValues&&!ge(t.defaultValues)&&t.formControl.reset(t.defaultValues,t.resetOptions);else{const{formControl:l,...i}=ji(t);r.current={...i,formState:n}}const o=r.current.control;return o._options=t,Fs(()=>{const l=o._subscribe({formState:o._proxyFormState,callback:()=>a({...o._formState}),reRenderRoot:!0});return a(i=>({...i,isReady:!0})),o._formState.isReady=!0,l},[o]),L.useEffect(()=>o._disableForm(t.disabled),[o,t.disabled]),L.useEffect(()=>{t.mode&&(o._options.mode=t.mode),t.reValidateMode&&(o._options.reValidateMode=t.reValidateMode)},[o,t.mode,t.reValidateMode]),L.useEffect(()=>{t.errors&&(o._setErrors(t.errors),o._focusError())},[o,t.errors]),L.useEffect(()=>{t.shouldUnregister&&o._subjects.state.next({values:o._getWatch()})},[o,t.shouldUnregister]),L.useEffect(()=>{if(o._proxyFormState.isDirty){const l=o._getDirty();l!==n.isDirty&&o._subjects.state.next({isDirty:l})}},[o,n.isDirty]),L.useEffect(()=>{var l;t.values&&!Ae(t.values,s.current)?(o._reset(t.values,{keepFieldsRef:!0,...o._options.resetOptions}),!((l=o._options.resetOptions)===null||l===void 0)&&l.keepIsValid||o._setValid(),s.current=t.values,a(i=>({...i}))):o._resetDefaultValues()},[o,t.values]),L.useEffect(()=>{o._state.mount||(o._setValid(),o._state.mount=!0),o._state.watch&&(o._state.watch=!1,o._subjects.state.next({...o._formState})),o._removeUnmounted()}),r.current.formState=kn(n,o),r.current}const ar=(t,r,s)=>{if(t&&"reportValidity"in t){const n=I(s,r);t.setCustomValidity(n&&n.message||""),t.reportValidity()}},Ns=(t,r)=>{for(const s in r.fields){const n=r.fields[s];n&&n.ref&&"reportValidity"in n.ref?ar(n.ref,s,t):n&&n.refs&&n.refs.forEach(a=>ar(a,s,t))}},or=(t,r)=>{r.shouldUseNativeValidation&&Ns(t,r);const s={};for(const n in t){const a=I(r.fields,n),o=Object.assign(t[n]||{},{ref:a&&a.ref});if(wi(r.names||Object.keys(t),n)){const l=Object.assign({},I(s,n));$(l,"root",o),$(s,n,l)}else $(s,n,o)}return s},wi=(t,r)=>{const s=lr(r);return t.some(n=>lr(n).match(`^${s}\\.\\d+`))};function lr(t){return t.replace(/\]|\[/g,"")}function On(t,r,s){function n(i,d){var m;Object.defineProperty(i,"_zod",{value:i._zod??{},enumerable:!1}),(m=i._zod).traits??(m.traits=new Set),i._zod.traits.add(t),r(i,d);for(const h in l.prototype)h in i||Object.defineProperty(i,h,{value:l.prototype[h].bind(i)});i._zod.constr=l,i._zod.def=d}const a=s?.Parent??Object;class o extends a{}Object.defineProperty(o,"name",{value:t});function l(i){var d;const m=s?.Parent?new o:this;n(m,i),(d=m._zod).deferred??(d.deferred=[]);for(const h of m._zod.deferred)h();return m}return Object.defineProperty(l,"init",{value:n}),Object.defineProperty(l,Symbol.hasInstance,{value:i=>s?.Parent&&i instanceof s.Parent?!0:i?._zod?.traits?.has(t)}),Object.defineProperty(l,"name",{value:t}),l}class Si extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}const Ni={};function Un(t){return Ni}function Ci(t,r){return typeof r=="bigint"?r.toString():r}const Fn=Error.captureStackTrace?Error.captureStackTrace:(...t)=>{};function Mt(t){return typeof t=="string"?t:t?.message}function Vn(t,r,s){const n={...t,path:t.path??[]};if(!t.message){const a=Mt(t.inst?._zod.def?.error?.(t))??Mt(r?.error?.(t))??Mt(s.customError?.(t))??Mt(s.localeError?.(t))??"Invalid input";n.message=a}return delete n.inst,delete n.continue,r?.reportInput||delete n.input,n}const Bn=(t,r)=>{t.name="$ZodError",Object.defineProperty(t,"_zod",{value:t._zod,enumerable:!1}),Object.defineProperty(t,"issues",{value:r,enumerable:!1}),Object.defineProperty(t,"message",{get(){return JSON.stringify(r,Ci,2)},enumerable:!0}),Object.defineProperty(t,"toString",{value:()=>t.message,enumerable:!1})},_i=On("$ZodError",Bn),zn=On("$ZodError",Bn,{Parent:Error}),Ei=t=>(r,s,n,a)=>{const o=n?Object.assign(n,{async:!1}):{async:!1},l=r._zod.run({value:s,issues:[]},o);if(l instanceof Promise)throw new Si;if(l.issues.length){const i=new(a?.Err??t)(l.issues.map(d=>Vn(d,o,Un())));throw Fn(i,a?.callee),i}return l.value},Ti=Ei(zn),ki=t=>async(r,s,n,a)=>{const o=n?Object.assign(n,{async:!0}):{async:!0};let l=r._zod.run({value:s,issues:[]},o);if(l instanceof Promise&&(l=await l),l.issues.length){const i=new(a?.Err??t)(l.issues.map(d=>Vn(d,o,Un())));throw Fn(i,a?.callee),i}return l.value},Ii=ki(zn);function ir(t,r){try{var s=t()}catch(n){return r(n)}return s&&s.then?s.then(void 0,r):s}function Ai(t,r){for(var s={};t.length;){var n=t[0],a=n.code,o=n.message,l=n.path.join(".");if(!s[l])if("unionErrors"in n){var i=n.unionErrors[0].errors[0];s[l]={message:i.message,type:i.code}}else s[l]={message:o,type:a};if("unionErrors"in n&&n.unionErrors.forEach(function(h){return h.errors.forEach(function(y){return t.push(y)})}),r){var d=s[l].types,m=d&&d[n.code];s[l]=Vs(l,r,s,a,m?[].concat(m,n.message):n.message)}t.shift()}return s}function Pi(t,r){for(var s={};t.length;){var n=t[0],a=n.code,o=n.message,l=n.path.join(".");if(!s[l])if(n.code==="invalid_union"&&n.errors.length>0){var i=n.errors[0][0];s[l]={message:i.message,type:i.code}}else s[l]={message:o,type:a};if(n.code==="invalid_union"&&n.errors.forEach(function(h){return h.forEach(function(y){return t.push(y)})}),r){var d=s[l].types,m=d&&d[n.code];s[l]=Vs(l,r,s,a,m?[].concat(m,n.message):n.message)}t.shift()}return s}function os(t,r,s){if(s===void 0&&(s={}),(function(n){return"_def"in n&&typeof n._def=="object"&&"typeName"in n._def})(t))return function(n,a,o){try{return Promise.resolve(ir(function(){return Promise.resolve(t[s.mode==="sync"?"parse":"parseAsync"](n,r)).then(function(l){return o.shouldUseNativeValidation&&Ns({},o),{errors:{},values:s.raw?Object.assign({},n):l}})},function(l){if((function(i){return Array.isArray(i?.issues)})(l))return{values:{},errors:or(Ai(l.errors,!o.shouldUseNativeValidation&&o.criteriaMode==="all"),o)};throw l}))}catch(l){return Promise.reject(l)}};if((function(n){return"_zod"in n&&typeof n._zod=="object"})(t))return function(n,a,o){try{return Promise.resolve(ir(function(){return Promise.resolve((s.mode==="sync"?Ti:Ii)(t,n,r)).then(function(l){return o.shouldUseNativeValidation&&Ns({},o),{errors:{},values:s.raw?Object.assign({},n):l}})},function(l){if((function(i){return i instanceof _i})(l))return{values:{},errors:or(Pi(l.issues,!o.shouldUseNativeValidation&&o.criteriaMode==="all"),o)};throw l}))}catch(l){return Promise.reject(l)}};throw new Error("Invalid input: not a Zod schema")}const ls=ni,Hn=u.createContext({}),ee=({...t})=>e.jsx(Hn.Provider,{value:{name:t.name},children:e.jsx(li,{...t})}),is=()=>{const t=u.useContext(Hn),r=u.useContext($n),{getFieldState:s}=ns(),n=In({name:t.name}),a=s(t.name,n);if(!t)throw new Error("useFormField should be used within <FormField>");const{id:o}=r;return{id:o,name:t.name,formItemId:`${o}-form-item`,formDescriptionId:`${o}-form-item-description`,formMessageId:`${o}-form-item-message`,...a}},$n=u.createContext({});function te({className:t,...r}){const s=u.useId();return e.jsx($n.Provider,{value:{id:s},children:e.jsx("div",{"data-slot":"form-item",className:q("grid gap-2",t),...r})})}function se({className:t,...r}){const{error:s,formItemId:n}=is();return e.jsx(pt,{"data-slot":"form-label","data-error":!!s,className:q("data-[error=true]:text-destructive",t),htmlFor:n,...r})}function J({...t}){const{error:r,formItemId:s,formDescriptionId:n,formMessageId:a}=is();return e.jsx(wa,{"data-slot":"form-control",id:s,"aria-describedby":r?`${n} ${a}`:`${n}`,"aria-invalid":!!r,...t})}function Ue({className:t,...r}){const{formDescriptionId:s}=is();return e.jsx("p",{"data-slot":"form-description",id:s,className:q("text-muted-foreground text-sm",t),...r})}function re({className:t,...r}){const{error:s,formMessageId:n}=is(),a=s?String(s?.message??""):r.children;return a?e.jsx("p",{"data-slot":"form-message",id:n,className:q("text-destructive text-sm",t),...r,children:a}):null}const Kn=[{id:"openai",name:"OpenAI",defaultBaseUrl:"https://api.openai.com/v1",defaultModelId:"gpt-4",supportsImages:!0,contextWindow:128e3,apiKeyUrl:"https://platform.openai.com/api-keys",setupGuideUrl:"https://docs.browseros.com/bring-your-own-keys/openai"},{id:"openai-compatible",name:"OpenAI Compatible",defaultBaseUrl:"",defaultModelId:"",supportsImages:!0,contextWindow:128e3},{id:"anthropic",name:"Anthropic",defaultBaseUrl:"https://api.anthropic.com/v1",defaultModelId:"claude-3-5-sonnet-20241022",supportsImages:!0,contextWindow:2e5,apiKeyUrl:"https://console.anthropic.com/settings/keys",setupGuideUrl:"https://docs.browseros.com/bring-your-own-keys/claude"},{id:"google",name:"Gemini",defaultBaseUrl:"https://generativelanguage.googleapis.com/v1beta",defaultModelId:"gemini-1.5-pro",supportsImages:!0,contextWindow:1e6,apiKeyUrl:"https://aistudio.google.com/app/apikey",setupGuideUrl:"https://docs.browseros.com/bring-your-own-keys/gemini"},{id:"ollama",name:"Ollama",defaultBaseUrl:"http://localhost:11434/v1",defaultModelId:"llama3.2",supportsImages:!1,contextWindow:128e3,setupGuideUrl:"https://docs.browseros.com/local-LLMs/ollama"},{id:"openrouter",name:"OpenRouter",defaultBaseUrl:"https://openrouter.ai/api/v1",defaultModelId:"openai/gpt-4-turbo",supportsImages:!0,contextWindow:128e3,apiKeyUrl:"https://openrouter.ai/keys",setupGuideUrl:"https://docs.browseros.com/bring-your-own-keys/openrouter"},{id:"lmstudio",name:"LM Studio",defaultBaseUrl:"http://localhost:1234/v1",defaultModelId:"local-model",supportsImages:!1,contextWindow:32e3,setupGuideUrl:"https://docs.browseros.com/local-LLMs/lm-studio"},{id:"azure",name:"Azure",defaultBaseUrl:"",defaultModelId:"",supportsImages:!0,contextWindow:128e3,apiKeyUrl:"https://portal.azure.com/#view/Microsoft_Azure_ProjectOxford/CognitiveServicesHub/~/OpenAI"},{id:"bedrock",name:"AWS Bedrock",defaultBaseUrl:"",defaultModelId:"",supportsImages:!0,contextWindow:2e5,setupGuideUrl:"https://docs.aws.amazon.com/bedrock/latest/userguide/getting-started.html"}],Di=[{value:"anthropic",label:"Anthropic"},{value:"openai",label:"OpenAI"},{value:"openai-compatible",label:"OpenAI Compatible"},{value:"google",label:"Gemini"},{value:"openrouter",label:"OpenRouter"},{value:"azure",label:"Azure"},{value:"ollama",label:"Ollama"},{value:"lmstudio",label:"LM Studio"},{value:"bedrock",label:"AWS Bedrock"},{value:"browseros",label:"BrowserOS"}],Ri=t=>Kn.find(r=>r.id===t),Mi={anthropic:"https://api.anthropic.com/v1",openai:"https://api.openai.com/v1","openai-compatible":"",google:"https://generativelanguage.googleapis.com/v1beta",openrouter:"https://openrouter.ai/api/v1",azure:"",ollama:"http://localhost:11434/v1",lmstudio:"http://localhost:1234/v1",bedrock:"",browseros:""},Lt=t=>Mi[t]||"",Li={anthropic:[{modelId:"claude-opus-4-5-20251101",contextLength:2e5},{modelId:"claude-haiku-4-5-20251001",contextLength:2e5},{modelId:"claude-sonnet-4-5-20250929",contextLength:2e5},{modelId:"claude-sonnet-4-20250514",contextLength:2e5},{modelId:"claude-opus-4-20250514",contextLength:2e5},{modelId:"claude-3-7-sonnet-20250219",contextLength:2e5},{modelId:"claude-3-5-haiku-20241022",contextLength:2e5}],openai:[{modelId:"gpt-5.2",contextLength:4e5},{modelId:"gpt-5.2-pro",contextLength:4e5},{modelId:"gpt-5",contextLength:4e5},{modelId:"gpt-5-mini",contextLength:4e5},{modelId:"gpt-5-nano",contextLength:4e5},{modelId:"gpt-4.1",contextLength:1e6},{modelId:"gpt-4.1-mini",contextLength:1e6},{modelId:"o4-mini",contextLength:2e5},{modelId:"o3-mini",contextLength:2e5},{modelId:"gpt-4o",contextLength:128e3},{modelId:"gpt-4o-mini",contextLength:128e3}],"openai-compatible":[],google:[{modelId:"gemini-3-pro-preview",contextLength:1048576},{modelId:"gemini-3-flash-preview",contextLength:1048576},{modelId:"gemini-2.5-flash",contextLength:1048576},{modelId:"gemini-2.5-pro",contextLength:1048576}],openrouter:[{modelId:"google/gemini-3-pro-preview",contextLength:1048576},{modelId:"google/gemini-3-flash-preview",contextLength:1048576},{modelId:"google/gemini-2.5-flash",contextLength:1048576},{modelId:"anthropic/claude-opus-4.5",contextLength:2e5},{modelId:"anthropic/claude-haiku-4.5",contextLength:2e5},{modelId:"anthropic/claude-sonnet-4.5",contextLength:2e5},{modelId:"anthropic/claude-sonnet-4",contextLength:2e5},{modelId:"anthropic/claude-3.7-sonnet",contextLength:2e5},{modelId:"openai/gpt-4o",contextLength:128e3},{modelId:"openai/gpt-oss-120b",contextLength:128e3},{modelId:"openai/gpt-oss-20b",contextLength:128e3},{modelId:"qwen/qwen3-14b",contextLength:131072},{modelId:"qwen/qwen3-8b",contextLength:131072}],azure:[],ollama:[{modelId:"qwen3:4b",contextLength:262144},{modelId:"qwen3:8b",contextLength:40960},{modelId:"qwen3:14b",contextLength:40960},{modelId:"gpt-oss:20b",contextLength:128e3},{modelId:"gpt-oss:120b",contextLength:128e3}],lmstudio:[{modelId:"openai/gpt-oss-20b",contextLength:128e3},{modelId:"openai/gpt-oss-120b",contextLength:128e3},{modelId:"qwen/qwen3-vl-8b",contextLength:131072}],bedrock:[],browseros:[]};function Wn(t){return Li[t]||[]}function Oi(t){const s=Wn(t).map(n=>n.modelId);return s.length>0?[...s,"custom"]:["custom"]}function Ui(t,r){return Wn(t).find(a=>a.modelId===r)?.contextLength}const Fi=Cr(["anthropic","openai","openai-compatible","google","openrouter","azure","ollama","lmstudio","bedrock","browseros"]),Vi=Jt({type:Fi,name:he().min(1,"Provider name is required").max(50),baseUrl:he().optional(),modelId:he().min(1,"Model ID is required"),apiKey:he().optional(),supportsImages:_r(),contextWindow:ps().int().min(1e3).max(2e6),temperature:ps().min(0).max(2),resourceName:he().optional(),accessKeyId:he().optional(),secretAccessKey:he().optional(),region:he().optional(),sessionToken:he().optional()}).superRefine((t,r)=>{t.type==="azure"?(!t.resourceName&&!t.baseUrl&&r.addIssue({code:Oe.custom,message:"Either Resource Name or Base URL is required",path:["resourceName"]}),t.apiKey||r.addIssue({code:Oe.custom,message:"API Key is required for Azure",path:["apiKey"]})):t.type==="bedrock"?(t.accessKeyId||r.addIssue({code:Oe.custom,message:"Access Key ID is required",path:["accessKeyId"]}),t.secretAccessKey||r.addIssue({code:Oe.custom,message:"Secret Access Key is required",path:["secretAccessKey"]}),t.region||r.addIssue({code:Oe.custom,message:"Region is required",path:["region"]})):t.baseUrl?/^https?:\/\/.+/.test(t.baseUrl)||r.addIssue({code:Oe.custom,message:"Must be a valid URL",path:["baseUrl"]}):r.addIssue({code:Oe.custom,message:"Base URL is required",path:["baseUrl"]})}),cr=({open:t,onOpenChange:r,initialValues:s,onSave:n})=>{const[a,o]=u.useState(!1),[l,i]=u.useState(!1),[d,m]=u.useState(null),{supports:h}=Ps(),{baseUrl:y}=it(),C=Di.filter(S=>S.value==="openai-compatible"?h(Ut.OPENAI_COMPATIBLE_SUPPORT):!0),x=as({resolver:os(Vi),defaultValues:{type:s?.type||"openai",name:s?.name||"",baseUrl:s?.baseUrl||Lt("openai"),modelId:s?.modelId||"",apiKey:s?.apiKey||"",supportsImages:s?.supportsImages??!1,contextWindow:s?.contextWindow||128e3,temperature:s?.temperature??.2,resourceName:s?.resourceName||"",accessKeyId:s?.accessKeyId||"",secretAccessKey:s?.secretAccessKey||"",region:s?.region||"",sessionToken:s?.sessionToken||""}}),_=x.watch("type"),b=x.watch("modelId"),E=x.watch("apiKey"),w=x.watch("baseUrl"),v=x.watch("resourceName"),p=x.watch("accessKeyId"),j=x.watch("secretAccessKey"),k=x.watch("region"),B=x.watch("sessionToken");u.useEffect(()=>{m(null)},[_,b,E,w,v,p,j,k,B]);const P=Oi(_),Y=S=>{x.setValue("type",S);const F=Lt(S);F&&x.setValue("baseUrl",F),x.setValue("modelId",""),o(!1)};u.useEffect(()=>{if(!s?.id&&b&&b!=="custom"){const S=Ui(_,b);S&&x.setValue("contextWindow",S)}},[b,_,x,s?.id]);const ne=S=>{S==="custom"?(o(!0),x.setValue("modelId","")):(o(!1),x.setValue("modelId",S))};u.useEffect(()=>{s&&(x.reset({type:s.type||"openai",name:s.name||"",baseUrl:s.baseUrl||Lt(s.type||"openai"),modelId:s.modelId||"",apiKey:s.apiKey||"",supportsImages:s.supportsImages??!1,contextWindow:s.contextWindow||128e3,temperature:s.temperature??.2,resourceName:s.resourceName||"",accessKeyId:s.accessKeyId||"",secretAccessKey:s.secretAccessKey||"",region:s.region||"",sessionToken:s.sessionToken||""}),o(!1))},[s,x]),u.useEffect(()=>{if(t&&!s){const S="openai";x.reset({type:S,name:"",baseUrl:Lt(S),modelId:"",apiKey:"",supportsImages:!1,contextWindow:128e3,temperature:.2,resourceName:"",accessKeyId:"",secretAccessKey:"",region:"",sessionToken:""}),o(!1)}m(null)},[t,s,x]);const O=async S=>{const F=!s?.id,Ee={id:s?.id||crypto.randomUUID(),...S,createdAt:s?.createdAt||Date.now(),updatedAt:Date.now()};await n(Ee),F&&Se(ao,{provider_type:S.type,model:S.modelId}),x.reset(),r(!1)},ae=()=>b?_==="azure"?!!(v||w)&&!!E:_==="bedrock"?!!p&&!!j&&!!k:!(!w||!["ollama","lmstudio"].includes(_)&&!E):!1,R=async()=>{if(!y){m({success:!1,message:"Server URL not available"});return}i(!0),m(null);try{const S=x.getValues(),F=await Xr({id:"test",type:S.type,name:S.name||"Test",baseUrl:S.baseUrl,modelId:S.modelId,apiKey:S.apiKey,supportsImages:S.supportsImages,contextWindow:S.contextWindow,temperature:S.temperature,createdAt:Date.now(),updatedAt:Date.now(),resourceName:S.resourceName,accessKeyId:S.accessKeyId,secretAccessKey:S.secretAccessKey,region:S.region,sessionToken:S.sessionToken},y);m(F)}catch(S){m({success:!1,message:S instanceof Error?S.message:"Test failed"})}finally{i(!1)}},U=Ri(_),z=U?.setupGuideUrl,K=U?.name,W=S=>{S.preventDefault(),z&&chrome.tabs.create({url:z})},Z=()=>_==="azure"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsx(ee,{control:x.control,name:"resourceName",render:({field:S})=>e.jsxs(te,{children:[e.jsx(se,{children:"Resource Name *"}),e.jsx(J,{children:e.jsx(de,{placeholder:"your-resource-name",...S})}),e.jsx(Ue,{children:"Azure OpenAI resource name"}),e.jsx(re,{})]})}),e.jsx(ee,{control:x.control,name:"baseUrl",render:({field:S})=>e.jsxs(te,{children:[e.jsx(se,{children:"Base URL Override"}),e.jsx(J,{children:e.jsx(de,{placeholder:"Optional custom URL",...S})}),e.jsx(Ue,{children:"Overrides resource name if set"}),e.jsx(re,{})]})})]}),e.jsx(ee,{control:x.control,name:"apiKey",render:({field:S})=>e.jsxs(te,{children:[e.jsx(se,{children:"API Key *"}),e.jsx(J,{children:e.jsx(de,{type:"password",placeholder:"Enter your Azure API key",...S})}),e.jsx(re,{})]})})]}):_==="bedrock"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsx(ee,{control:x.control,name:"accessKeyId",render:({field:S})=>e.jsxs(te,{children:[e.jsx(se,{children:"Access Key ID *"}),e.jsx(J,{children:e.jsx(de,{placeholder:"AKIA...",...S})}),e.jsx(re,{})]})}),e.jsx(ee,{control:x.control,name:"secretAccessKey",render:({field:S})=>e.jsxs(te,{children:[e.jsx(se,{children:"Secret Access Key *"}),e.jsx(J,{children:e.jsx(de,{type:"password",placeholder:"Enter your secret access key",...S})}),e.jsx(re,{})]})})]}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsx(ee,{control:x.control,name:"region",render:({field:S})=>e.jsxs(te,{children:[e.jsx(se,{children:"Region *"}),e.jsx(J,{children:e.jsx(de,{placeholder:"us-east-1",...S})}),e.jsx(re,{})]})}),e.jsx(ee,{control:x.control,name:"sessionToken",render:({field:S})=>e.jsxs(te,{children:[e.jsx(se,{children:"Session Token"}),e.jsx(J,{children:e.jsx(de,{type:"password",placeholder:"Optional (for STS credentials)",...S})}),e.jsx(Ue,{children:"Required for temporary credentials"}),e.jsx(re,{})]})})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(ee,{control:x.control,name:"baseUrl",render:({field:S})=>e.jsxs(te,{children:[e.jsx(se,{children:"Base URL *"}),e.jsx(J,{children:e.jsx(de,{placeholder:"https://api.openai.com/v1",...S})}),e.jsx(re,{})]})}),e.jsx(ee,{control:x.control,name:"apiKey",render:({field:S})=>{const F=["ollama","lmstudio"].includes(_);return e.jsxs(te,{children:[e.jsxs(se,{children:["API Key",F?"":" *"]}),e.jsx(J,{children:e.jsx(de,{type:"password",placeholder:F?"Enter your API key (optional)":"Enter your API key",...S})}),e.jsxs(Ue,{children:["Your API key is encrypted and stored locally."," ",z&&e.jsxs("a",{href:z,onClick:W,className:"inline-flex cursor-pointer items-center gap-1 text-primary hover:underline",children:[e.jsx(Or,{className:"h-3 w-3"}),K," setup guide"]})]}),e.jsx(re,{})]})}})]});return e.jsx(Et,{open:t,onOpenChange:r,children:e.jsxs(Tt,{className:"sm:max-w-2xl",children:[e.jsxs(kt,{children:[e.jsx(It,{children:s?.id?"Edit Provider":"Configure New Provider"}),e.jsx(At,{children:s?.id?"Update your LLM provider configuration.":"Add a new LLM provider configuration with API key and model settings."})]}),e.jsx(ls,{...x,children:e.jsxs("form",{onSubmit:x.handleSubmit(O),className:"space-y-5",children:[e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsx(ee,{control:x.control,name:"type",render:({field:S})=>e.jsxs(te,{children:[e.jsx(se,{children:"Provider Type *"}),e.jsxs(Vt,{onValueChange:F=>Y(F),value:S.value,children:[e.jsx(J,{children:e.jsx(zt,{className:"w-full",children:e.jsx(Bt,{placeholder:"Select provider type"})})}),e.jsx(Ht,{children:C.map(F=>e.jsx(ot,{value:F.value,children:F.label},F.value))})]}),e.jsx(re,{})]})}),e.jsx(ee,{control:x.control,name:"name",render:({field:S})=>e.jsxs(te,{children:[e.jsx(se,{children:"Provider Name *"}),e.jsx(J,{children:e.jsx(de,{placeholder:"e.g., Work OpenAI",...S})}),e.jsx(re,{})]})})]}),Z(),e.jsx(ee,{control:x.control,name:"modelId",render:({field:S})=>e.jsxs(te,{children:[e.jsx(se,{children:"Model *"}),a||P.length===1?e.jsxs(e.Fragment,{children:[e.jsx(J,{children:e.jsx(de,{placeholder:_==="azure"?"Enter your deployment name":_==="bedrock"?"e.g., anthropic.claude-3-5-sonnet-20241022-v2:0":"Enter custom model ID",...S})}),P.length>1&&e.jsx(V,{type:"button",variant:"link",size:"sm",className:"h-auto p-0 text-xs",onClick:()=>o(!1),children:"← Back to model list"})]}):e.jsxs(Vt,{onValueChange:ne,value:S.value,children:[e.jsx(J,{children:e.jsx(zt,{className:"w-full",children:e.jsx(Bt,{placeholder:"Select a model"})})}),e.jsx(Ht,{children:P.map(F=>e.jsx(ot,{value:F,children:F==="custom"?"+ Custom model":F},F))})]}),e.jsx(re,{})]})}),e.jsxs("div",{className:"space-y-4 border-border border-t pt-4",children:[e.jsx("h4",{className:"font-medium text-sm",children:"Model Configuration"}),e.jsx(ee,{control:x.control,name:"supportsImages",render:({field:S})=>e.jsxs(te,{className:"flex items-center gap-2 space-y-0",children:[e.jsx(J,{children:e.jsx(Pr,{checked:S.value,onCheckedChange:S.onChange})}),e.jsx(se,{className:"font-normal",children:"Supports Images"})]})}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsx(ee,{control:x.control,name:"contextWindow",render:({field:S})=>e.jsxs(te,{children:[e.jsx(se,{children:"Context Window Size"}),e.jsx(J,{children:e.jsx(de,{type:"number",...S,onChange:F=>S.onChange(Number(F.target.value))})}),e.jsx(Ue,{children:"Auto-filled based on model"}),e.jsx(re,{})]})}),e.jsx(ee,{control:x.control,name:"temperature",render:({field:S})=>e.jsxs(te,{children:[e.jsx(se,{children:"Temperature (0-2)"}),e.jsx(J,{children:e.jsx(de,{type:"number",step:"0.1",min:"0",max:"2",...S,onChange:F=>S.onChange(Number(F.target.value))})}),e.jsx(Ue,{children:"Controls response randomness"}),e.jsx(re,{})]})})]})]}),d&&e.jsxs("div",{className:`flex items-center gap-2 rounded-lg border p-3 text-sm ${d.success?"border-green-200 bg-green-50 text-green-700 dark:border-green-800 dark:bg-green-950 dark:text-green-300":"border-red-200 bg-red-50 text-red-700 dark:border-red-800 dark:bg-red-950 dark:text-red-300"}`,children:[d.success?e.jsx(ks,{className:"h-4 w-4 shrink-0"}):e.jsx(Dr,{className:"h-4 w-4 shrink-0"}),e.jsx("span",{className:"flex-1",children:d.message}),d.responseTime&&e.jsxs("span",{className:"text-xs opacity-70",children:[d.responseTime,"ms"]})]}),e.jsxs(Gt,{className:"gap-3",children:[e.jsx(V,{type:"button",variant:"outline",onClick:()=>r(!1),children:"Cancel"}),e.jsxs(V,{type:"button",variant:"outline",onClick:R,disabled:!ae()||l,children:[l&&e.jsx(De,{className:"mr-2 h-4 w-4 animate-spin"}),l?"Testing...":"Test"]}),e.jsx(V,{type:"submit",disabled:l,children:s?.id?"Update":"Save"})]})]})})]})})},Bi=({template:t,onUseTemplate:r})=>e.jsxs("button",{type:"button",onClick:()=>r(t),className:"group flex w-full items-center justify-between rounded-lg border border-border bg-background p-4 text-left transition-all hover:border-[var(--accent-orange)] hover:shadow-md",children:[e.jsxs("div",{className:"flex items-center gap-3 text-accent-orange/70 transition-colors group-hover:text-accent-orange",children:[e.jsx(Nr,{type:t.id,size:28}),e.jsx("span",{className:"font-medium text-foreground",children:t.name})]}),e.jsx(Tr,{variant:"outline",className:"rounded-md px-3 py-1 transition-colors group-hover:border-[var(--accent-orange)] group-hover:text-[var(--accent-orange)]",children:"USE"})]}),zi=({onUseTemplate:t})=>{const{supports:r}=Ps(),s=Kn.filter(n=>n.id==="openai-compatible"?r(Ut.OPENAI_COMPATIBLE_SUPPORT):!0);return e.jsx(Yt,{defaultOpen:!0,className:"group/collapsible",children:e.jsxs("div",{className:"rounded-xl border border-border bg-card p-6 shadow-sm transition-all hover:shadow-md",children:[e.jsxs(Zt,{className:"mb-4 flex w-full items-center justify-between text-left",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg",children:"Quick provider templates"}),e.jsxs("p",{className:"text-muted-foreground text-sm",children:[s.length," templates available"]})]}),e.jsx(ct,{className:q("h-5 w-5 transition-transform","group-data-[state=open]/collapsible:rotate-180")})]}),e.jsx(Xt,{children:e.jsx("div",{className:"mt-4 grid gap-3 sm:grid-cols-2 lg:grid-cols-3",children:s.map(n=>e.jsx(Bi,{template:n,onUseTemplate:t},n.id))})})]})})},dr=()=>{const{providers:t,defaultProviderId:r,saveProvider:s,setDefaultProvider:n,deleteProvider:a}=Fa(),{baseUrl:o}=it(),[l,i]=u.useState(!1),[d,m]=u.useState(!1),[h,y]=u.useState(),[C,x]=u.useState(null),[_,b]=u.useState(null),[E,w]=u.useState(null),v=()=>{y(void 0),i(!0)},p=O=>{y({type:O.id,name:O.name,baseUrl:O.defaultBaseUrl,modelId:O.defaultModelId,supportsImages:O.supportsImages,contextWindow:O.contextWindow,temperature:.2}),i(!0)},j=O=>{x(O),m(!0)},k=O=>{b(O)},B=async()=>{_&&(await a(_.id),b(null))},P=async O=>{await s(O)},Y=O=>{n(O)},ne=async O=>{if(!o){Fe.error("Test Failed",{description:e.jsx("span",{className:"text-red-600 text-sm dark:text-red-400",children:"Server URL not available"}),duration:3e3});return}w(O.id);try{const ae=await Xr(O,o);ae.success?Fe.success("Test Successful",{description:e.jsx("span",{className:"text-green-600 text-sm dark:text-green-400",children:ae.message}),duration:3e3}):Fe.error("Test Failed",{description:e.jsx("span",{className:"text-red-600 text-sm dark:text-red-400",children:ae.message}),duration:3e3})}catch(ae){Fe.error("Test Failed",{description:e.jsx("span",{className:"text-red-600 text-sm dark:text-red-400",children:ae instanceof Error?ae.message:"Unknown error"}),duration:3e3})}w(null)};return e.jsxs("div",{className:"fade-in slide-in-from-bottom-5 animate-in space-y-6 duration-500",children:[e.jsx(ti,{providers:t,defaultProviderId:r,onDefaultProviderChange:n,onAddProvider:v}),e.jsx(zi,{onUseTemplate:p}),e.jsx(gl,{providers:t,selectedProviderId:r,testingProviderId:E,onSelectProvider:Y,onTestProvider:ne,onEditProvider:j,onDeleteProvider:k}),e.jsx(cr,{open:l,onOpenChange:i,initialValues:h,onSave:P}),e.jsx(cr,{open:d,onOpenChange:m,initialValues:C??void 0,onSave:P}),e.jsx(yt,{open:!!_,onOpenChange:O=>!O&&b(null),children:e.jsxs(bt,{children:[e.jsxs(jt,{children:[e.jsx(St,{children:"Delete Provider"}),e.jsxs(Nt,{children:['Are you sure you want to delete "',_?.name,'"? This action cannot be undone.']})]}),e.jsxs(wt,{children:[e.jsx(_t,{children:"Cancel"}),e.jsx(Ct,{onClick:B,children:"Delete"})]})]})})]})},Hi=Jt({name:he().min(1,"Server name is required"),url:he().url("Please enter a valid URL"),description:he().optional()}),$i=({open:t,onOpenChange:r,onAddServer:s})=>{const n=as({resolver:os(Hi),defaultValues:{name:"",url:"",description:""}}),a=l=>{l||n.reset(),r(l)},o=l=>{s({name:l.name,url:l.url,description:l.description??""}),n.reset(),r(!1)};return e.jsx(Et,{open:t,onOpenChange:a,children:e.jsxs(Tt,{className:"max-w-md",children:[e.jsxs(kt,{children:[e.jsx(It,{children:"Add Custom MCP Server"}),e.jsx(At,{children:"Configure your custom MCP server connection"})]}),e.jsx(ls,{...n,children:e.jsxs("form",{onSubmit:n.handleSubmit(o),className:"space-y-4",children:[e.jsx(ee,{control:n.control,name:"name",render:({field:l})=>e.jsxs(te,{children:[e.jsx(se,{children:"Server Name"}),e.jsx(J,{children:e.jsx(de,{placeholder:"My Custom MCP",...l})}),e.jsx(re,{})]})}),e.jsx(ee,{control:n.control,name:"url",render:({field:l})=>e.jsxs(te,{children:[e.jsx(se,{children:"Server URL"}),e.jsx(Ue,{children:"(only supports HTTP)"}),e.jsx(J,{children:e.jsx(de,{type:"url",placeholder:"http://mcp.example.com",...l})}),e.jsx(re,{})]})}),e.jsx(ee,{control:n.control,name:"description",render:({field:l})=>e.jsxs(te,{children:[e.jsx(se,{children:"Description (Optional)"}),e.jsx(J,{children:e.jsx(Is,{placeholder:"Describe what this server does...",rows:3,className:"resize-none",...l})}),e.jsx(re,{})]})}),e.jsxs(Gt,{children:[e.jsx(V,{type:"button",variant:"outline",onClick:()=>a(!1),children:"Cancel"}),e.jsx(V,{type:"submit",className:"bg-[var(--accent-orange)] text-white hover:bg-[var(--accent-orange-bright)]",children:"Add Server"})]})]})})]})})},Ki=({open:t,onOpenChange:r,serversList:s,onAddServer:n})=>{const a=o=>{n(o),r(!1)};return e.jsx(Et,{open:t,onOpenChange:r,children:e.jsxs(Tt,{className:"max-w-md",children:[e.jsxs(kt,{children:[e.jsx(It,{children:"Enable built-in MCP Server"}),e.jsx(At,{children:"Select a built-in MCP server to enable"})]}),e.jsx("div",{className:"styled-scrollbar max-h-[400px] w-full space-y-2 overflow-y-auto",children:s?.map(o=>{const{name:l,description:i}=o;return e.jsxs(V,{variant:"outline",onClick:()=>a(o),className:"group h-auto w-full items-center gap-3 p-3 hover:border-[var(--accent-orange)] hover:bg-[var(--accent-orange)]/5",children:[e.jsx(lt,{className:"h-5 w-5 shrink-0 text-muted-foreground"}),e.jsxs("div",{className:"flex w-[calc(100%-64px)] flex-1 flex-col items-start gap-1",children:[e.jsx("span",{className:"font-medium",children:l}),i&&e.jsx("p",{className:"line-clamp-1 w-full text-ellipsis text-left text-muted-foreground text-xs",children:i})]}),e.jsx(Ke,{className:"h-4 w-4 shrink-0 text-muted-foreground"})]},l)})??null})]})})},Wi=({availableServers:t,onAddServer:r,isLoading:s})=>{const[n,a]=u.useState(!1);return e.jsx(Yt,{open:n,onOpenChange:a,children:e.jsxs("div",{className:"rounded-xl border border-border bg-card p-6 shadow-sm transition-all hover:shadow-md",children:[e.jsxs(Zt,{className:"flex w-full cursor-pointer items-center justify-between hover:opacity-50",children:[e.jsxs("div",{className:"flex flex-col items-start",children:[e.jsx("h3",{className:"font-semibold text-lg",children:"Built-in Servers"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:s?"Loading...":`${t?.length} servers available`})]}),e.jsx(ct,{className:`h-5 w-5 text-muted-foreground transition-transform duration-200 ${n?"rotate-180":""}`})]}),e.jsx(Xt,{className:"pt-4",children:s?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(De,{className:"h-6 w-6 animate-spin text-muted-foreground"})}):e.jsx("div",{className:"grid gap-3 sm:grid-cols-2 lg:grid-cols-3",children:t?.map(o=>{const{name:l,description:i}=o;return e.jsxs(V,{variant:"outline",onClick:()=>r(o),className:"group h-auto flex-col items-start gap-2 p-4 hover:border-[var(--accent-orange)]",children:[e.jsxs("div",{className:"flex w-full items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(lt,{className:"h-5 w-5 text-muted-foreground transition-colors group-hover:text-[var(--accent-orange)]"}),e.jsx("span",{className:"font-medium",children:l})]}),e.jsx(Ke,{className:"h-4 w-4 text-muted-foreground transition-colors group-hover:text-[var(--accent-orange)]"})]}),i&&e.jsx("p",{className:"line-clamp-1 max-w-48 text-ellipsis text-left text-muted-foreground text-xs",children:i})]},l)})??null})})]})})},ur=$a?t=>{t()}:L.startTransition,qi=t=>{const[,r]=u.useState({}),s=u.useRef(!1),n=u.useRef(t),a=u.useRef({data:!1,error:!1,isValidating:!1}),o=u.useCallback(l=>{let i=!1;const d=n.current;for(const m in l)if(Object.prototype.hasOwnProperty.call(l,m)){const h=m;d[h]!==l[h]&&(d[h]=l[h],a.current[h]&&(i=!0))}i&&!s.current&&r({})},[]);return kr(()=>(s.current=!1,()=>{s.current=!0})),[n,a.current,o]},Gi=()=>(t,r,s={})=>{const{mutate:n}=Ka(),a=u.useRef(t),o=u.useRef(r),l=u.useRef(s),i=u.useRef(0),[d,m,h]=qi({data:Rt,error:Rt,isMutating:!1}),y=d.current,C=u.useCallback(async(_,b)=>{const[E,w]=Wa(a.current);if(!o.current)throw new Error("Can’t trigger the mutation: missing fetcher.");if(!E)throw new Error("Can’t trigger the mutation: missing key.");const v=ms(ms({populateCache:!1,throwOnError:!0},l.current),b),p=qs();i.current=p,h({isMutating:!0});try{const j=await n(E,o.current(w,{arg:_}),ms(v,{throwOnError:!0}));return i.current<=p&&(ur(()=>h({data:j,isMutating:!1,error:void 0})),v.onSuccess==null||v.onSuccess.call(v,j,E,v)),j}catch(j){if(i.current<=p&&(ur(()=>h({error:j,isMutating:!1})),v.onError==null||v.onError.call(v,j,E,v),v.throwOnError))throw j}},[]),x=u.useCallback(()=>{i.current=qs(),h({data:Rt,error:Rt,isMutating:!1})},[]);return kr(()=>{a.current=t,o.current=r,l.current=s}),{trigger:C,reset:x,get data(){return m.data=!0,y.data},get error(){return m.error=!0,y.error},get isMutating(){return m.isMutating=!0,y.isMutating}}},qn=Ha(As,Gi),Ji=async(t,{arg:r})=>{const s=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({serverName:r.serverName})});if(!s.ok){const n=await s.json();throw new Error(n.error||"Failed to add server")}return s.json()},Yi=()=>{const{baseUrl:t}=it();return qn(t?`${t}/klavis/servers/add`:null,Ji)},Zi=async([t])=>await(await fetch(`${t}/klavis/servers`)).json(),Xi=()=>{const{baseUrl:t}=it();return As(t?[t,"klavis/servers"]:null,Zi,{keepPreviousData:!0})},Qi=async([t])=>await(await fetch(`${t}/klavis/user-integrations`)).json(),ec=()=>{const{baseUrl:t}=it();return As(t?[t,"klavis/user-integrations"]:null,Qi,{keepPreviousData:!0,revalidateOnFocus:!0})},tc=async(t,{arg:r})=>{const s=await fetch(t,{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({serverName:r.serverName})});if(!s.ok){const n=await s.json();throw new Error(n.error||"Failed to remove server")}return s.json()},sc=()=>{const{baseUrl:t}=it();return qn(t?`${t}/klavis/servers/remove`:null,tc)},Ot=(t,r)=>{Fe.error(`Failed to add MCP Server: ${t}`),wr.captureException(r)},mr=(t,r)=>{Fe.error(`Failed to remove MCP Server: ${t}`),wr.captureException(r)},rc=()=>{const{servers:t,addServer:r,removeServer:s}=Va(),[n,a]=u.useState(!1),[o,l]=u.useState(!1),[i,d]=u.useState(null),{trigger:m}=Yi(),{trigger:h}=sc(),{data:y}=Xi(),{data:C,isLoading:x}=ec(),_=async p=>{try{const k=(await m({serverName:p})).oauthUrl;if(!k){Ot(p,"No auth URL returned");return}window.open(k,"_blank")?.focus()}catch(j){Ot(p,j)}},b=async({name:p,description:j})=>{try{const B=(await m({serverName:p})).oauthUrl;if(!B){Ot(p,"No auth URL returned");return}window.open(B,"_blank")?.focus(),r({id:Date.now().toString(),displayName:`${p} MCP`,type:"managed",managedServerName:p,managedServerDescription:j}),Se(oo,{server_name:p})}catch(k){Ot(p,k)}},E=async({id:p,name:j})=>{d(p);try{(await h({serverName:j})).success?s(p):mr(j,"Success not returned from server")}catch(k){mr(j,k)}finally{d(null)}},w=p=>{r({id:Date.now().toString(),displayName:p.name,type:"custom",config:{url:p.url,description:p.description}}),Se(lo)},v=y?.servers.filter(p=>{const j=p.name;return!t.find(k=>k.managedServerName===j)});return e.jsxs("div",{className:"fade-in slide-in-from-bottom-5 animate-in space-y-6 duration-500",children:[e.jsx("div",{className:"rounded-xl border border-border bg-card p-6 shadow-sm transition-all hover:shadow-md",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"flex h-12 w-12 shrink-0 items-center justify-center rounded-xl bg-[var(--accent-orange)]/10",children:e.jsx(lt,{className:"h-6 w-6 text-[var(--accent-orange)]"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"mb-1 font-semibold text-xl",children:"MCP Servers"}),e.jsx("p",{className:"mb-6 text-muted-foreground text-sm",children:"Connect BrowserOS assistant to MCP servers to send email, schedule calendar events, write docs, and more"}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsxs(V,{variant:"outline",onClick:()=>a(!0),className:"border-[var(--accent-orange)] bg-[var(--accent-orange)]/10 text-[var(--accent-orange)] hover:bg-[var(--accent-orange)]/20",children:[e.jsx(Ke,{className:"h-4 w-4"}),e.jsx("span",{children:"Enable built-in MCP"})]}),e.jsxs(V,{variant:"outline",onClick:()=>l(!0),children:[e.jsx(Ke,{className:"h-4 w-4"}),e.jsx("span",{children:"Add Custom MCP"})]})]})]})]})}),t.length>0&&e.jsxs("div",{className:"rounded-xl border border-border bg-card p-6 shadow-sm transition-all hover:shadow-md",children:[e.jsx("h3",{className:"mb-4 font-semibold text-lg",children:"Your MCP Servers"}),e.jsx("div",{className:"space-y-3",children:t.map(p=>e.jsxs("div",{className:"flex items-center gap-4 rounded-lg border border-border bg-background p-4 transition-all hover:border-[var(--accent-orange)]/50 hover:shadow-sm",children:[e.jsx("div",{className:"flex h-10 w-10 shrink-0 items-center justify-center rounded-lg bg-[var(--accent-orange)]/10",children:e.jsx(lt,{className:"h-5 w-5 text-[var(--accent-orange)]"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"mb-1 flex items-center gap-2",children:[e.jsx("span",{className:"font-semibold",children:p.displayName}),e.jsx("span",{className:`rounded px-2 py-0.5 font-medium text-xs ${p.type==="managed"?"bg-[var(--accent-orange)]/10 text-[var(--accent-orange)]":"bg-muted text-muted-foreground"}`,children:p.type==="managed"?"Built-in":"Custom"})]}),e.jsx("p",{className:"text-muted-foreground text-sm",children:p.managedServerDescription||p.config?.description||p.config?.url})]}),p.type==="managed"&&(x?e.jsx(De,{className:"h-4 w-4 animate-spin text-muted-foreground"}):C?.integrations?.find(j=>j.name===p.managedServerName)?.is_authenticated?e.jsxs("span",{className:"flex items-center gap-1 rounded-full bg-green-500/10 px-2 py-1 font-medium text-green-600 text-xs",children:[e.jsx(qt,{className:"h-3 w-3"}),"Authenticated"]}):e.jsx(V,{variant:"outline",size:"sm",onClick:()=>p.managedServerName&&_(p.managedServerName),children:"Authenticate"})),e.jsx(V,{variant:"ghost",size:"icon",disabled:i===p.id,onClick:()=>{p.type==="managed"&&p.managedServerName?E({id:p.id,name:p.managedServerName}):s(p.id)},className:"text-muted-foreground hover:bg-destructive/10 hover:text-destructive",title:"Remove server",children:i===p.id?e.jsx(De,{className:"h-4 w-4 animate-spin"}):e.jsx(Qt,{className:"h-4 w-4"})})]},p.id))})]}),e.jsx(Wi,{availableServers:v,onAddServer:b,isLoading:!1}),e.jsx(Ki,{open:n,onOpenChange:a,serversList:v,onAddServer:b}),e.jsx($i,{open:o,onOpenChange:l,onAddServer:w})]})},nc=()=>e.jsx("div",{className:"rounded-xl border border-border bg-card p-6 shadow-sm transition-all hover:shadow-md",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"flex h-12 w-12 shrink-0 items-center justify-center rounded-xl bg-[var(--accent-orange)]/10",children:e.jsx(Fr,{className:"h-6 w-6 text-[var(--accent-orange)]"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"mb-1 font-semibold text-xl",children:"Customization"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"Personalize your toolbar and browser interface"})]})]})});var cs="Switch",[ac]=Es(cs),[oc,lc]=ac(cs),Gn=u.forwardRef((t,r)=>{const{__scopeSwitch:s,name:n,checked:a,defaultChecked:o,required:l,disabled:i,value:d="on",onCheckedChange:m,form:h,...y}=t,[C,x]=u.useState(null),_=je(r,p=>x(p)),b=u.useRef(!1),E=C?h||!!C.closest("form"):!0,[w,v]=hs({prop:a,defaultProp:o??!1,onChange:m,caller:cs});return e.jsxs(oc,{scope:s,checked:w,disabled:i,children:[e.jsx(ye.button,{type:"button",role:"switch","aria-checked":w,"aria-required":l,"data-state":Xn(w),"data-disabled":i?"":void 0,disabled:i,value:d,...y,ref:_,onClick:fe(t.onClick,p=>{v(j=>!j),E&&(b.current=p.isPropagationStopped(),b.current||p.stopPropagation())})}),E&&e.jsx(Zn,{control:C,bubbles:!b.current,name:n,value:d,checked:w,required:l,disabled:i,form:h,style:{transform:"translateX(-100%)"}})]})});Gn.displayName=cs;var Jn="SwitchThumb",Yn=u.forwardRef((t,r)=>{const{__scopeSwitch:s,...n}=t,a=lc(Jn,s);return e.jsx(ye.span,{"data-state":Xn(a.checked),"data-disabled":a.disabled?"":void 0,...n,ref:r})});Yn.displayName=Jn;var ic="SwitchBubbleInput",Zn=u.forwardRef(({__scopeSwitch:t,control:r,checked:s,bubbles:n=!0,...a},o)=>{const l=u.useRef(null),i=je(l,o),d=Ar(s),m=io(r);return u.useEffect(()=>{const h=l.current;if(!h)return;const y=window.HTMLInputElement.prototype,x=Object.getOwnPropertyDescriptor(y,"checked").set;if(d!==s&&x){const _=new Event("click",{bubbles:n});x.call(h,s),h.dispatchEvent(_)}},[d,s,n]),e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:s,...a,tabIndex:-1,ref:i,style:{...a.style,...m,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});Zn.displayName=ic;function Xn(t){return t?"checked":"unchecked"}var cc=Gn,dc=Yn;function vt({className:t,...r}){return e.jsx(cc,{"data-slot":"switch",className:q("peer inline-flex h-5 w-9 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent shadow-xs outline-none transition-colors focus-visible:ring-[3px] focus-visible:ring-ring/50 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",t),...r,children:e.jsx(dc,{"data-slot":"switch-thumb",className:q("pointer-events-none block h-4 w-4 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0")})})}const uc=()=>{const[t,r]=u.useState(!0),[s,n]=u.useState(!0),[a,o]=u.useState(!0),[l,i]=u.useState(!0);u.useEffect(()=>{(async()=>{try{const h=He(),[y,C,x]=await Promise.all([h.getPref(_e.SHOW_LLM_CHAT),h.getPref(_e.SHOW_LLM_HUB),h.getPref(_e.SHOW_TOOLBAR_LABELS)]);r(y?.value!==!1),n(C?.value!==!1),o(x?.value!==!1)}catch{}finally{i(!1)}})()},[]);const d=async(m,h,y)=>{try{await He().setPref(m,h),y(h)}catch{Fe.error("Failed to update setting")}};return e.jsxs("div",{className:"rounded-xl border border-border bg-card p-6 shadow-sm transition-all hover:shadow-md",children:[e.jsx("h3",{className:"mb-4 font-semibold text-lg",children:"Toolbar Settings"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(pt,{htmlFor:"show-llm-chat",className:"font-medium text-sm",children:"Show Chat Button"}),e.jsx("p",{className:"text-muted-foreground text-xs",children:"Display the Chat button in the browser toolbar"})]}),e.jsx(vt,{id:"show-llm-chat",checked:t,onCheckedChange:m=>d(_e.SHOW_LLM_CHAT,m,r),disabled:l})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(pt,{htmlFor:"show-llm-hub",className:"font-medium text-sm",children:"Show Hub Button"}),e.jsx("p",{className:"text-muted-foreground text-xs",children:"Display the Hub button in the browser toolbar"})]}),e.jsx(vt,{id:"show-llm-hub",checked:s,onCheckedChange:m=>d(_e.SHOW_LLM_HUB,m,n),disabled:l})]}),e.jsxs("div",{className:"flex items-center justify-between border-border border-t pt-4",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(pt,{htmlFor:"show-toolbar-labels",className:"font-medium text-sm",children:"Show Button Labels"}),e.jsx("p",{className:"text-muted-foreground text-xs",children:"Display text labels next to toolbar button icons"})]}),e.jsx(vt,{id:"show-toolbar-labels",checked:a,onCheckedChange:m=>d(_e.SHOW_TOOLBAR_LABELS,m,o),disabled:l})]})]})]})},mc=()=>e.jsxs("div",{className:"fade-in slide-in-from-bottom-5 animate-in space-y-6 duration-500",children:[e.jsx(nc,{}),e.jsx(uc,{})]}),fc=({message:t})=>{const r=t.role==="user";return e.jsx("div",{className:q("flex",r?"justify-end":"justify-start"),children:e.jsx("div",{className:q("max-w-[80%] rounded-2xl px-4 py-3 text-sm",r?"bg-primary text-primary-foreground":"bg-muted/50 text-foreground"),children:t.content?e.jsx(co,{children:t.content}):e.jsxs("span",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(De,{className:"h-4 w-4 animate-spin"}),"Thinking..."]})})})},hc=({messages:t,isStreaming:r,onSendMessage:s,onStop:n})=>{const[a,o]=u.useState(""),l=u.useRef(null),i=t.length;u.useEffect(()=>{l.current?.scrollIntoView({behavior:"smooth"})},[i]);const d=h=>{h.preventDefault(),!(!a.trim()||r)&&(s(a.trim()),o(""))},m=h=>{h.key==="Enter"&&!h.shiftKey&&(h.preventDefault(),d(h))};return e.jsxs("div",{className:"flex h-[calc(100vh-250px)] flex-col rounded-xl border border-border bg-card shadow-sm",children:[e.jsxs("div",{className:"flex-1 space-y-4 overflow-y-auto p-4",children:[t.map(h=>e.jsx(fc,{message:h},h.id)),e.jsx("div",{ref:l})]}),e.jsx("form",{onSubmit:d,className:"border-border border-t p-4",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Is,{value:a,onChange:h=>o(h.target.value),onKeyDown:m,placeholder:"Type your response...",disabled:r,className:"max-h-40 min-h-[44px] resize-none",rows:1}),r?e.jsx(V,{type:"button",onClick:n,variant:"destructive",size:"icon",children:e.jsx(Wo,{className:"h-4 w-4"})}):e.jsx(V,{type:"submit",disabled:!a.trim(),size:"icon",children:e.jsx(Ba,{className:"h-4 w-4"})})]})})]})},pc=()=>e.jsx("div",{className:"rounded-xl border border-border bg-card p-6 shadow-sm transition-all hover:shadow-md",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"flex h-12 w-12 shrink-0 items-center justify-center rounded-xl bg-[var(--accent-orange)]/10",children:e.jsx(Ur,{className:"h-6 w-6 text-[var(--accent-orange)]"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"mb-1 font-semibold text-xl",children:"Product Survey"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"Share your experience with BrowserOS to help us improve"})]})]})}),xc=({onStart:t,isLoading:r})=>e.jsxs("div",{className:"rounded-xl border border-border bg-card p-8 text-center shadow-sm",children:[e.jsx("div",{className:"mx-auto mb-4 flex h-16 w-16 items-center justify-center rounded-full bg-[var(--accent-orange)]/10",children:e.jsx(Sa,{className:"h-8 w-8 text-[var(--accent-orange)]"})}),e.jsx("h3",{className:"mb-2 font-semibold text-lg",children:"Share Your Experience"}),e.jsx("p",{className:"mx-auto mb-6 max-w-md text-muted-foreground text-sm",children:"We'd love to learn about how you use browser automation. This quick conversation helps us build features that matter to you."}),e.jsx(V,{onClick:t,disabled:r,size:"lg",children:r?"Starting...":"Start Survey"})]}),fr="https://jtbd-agent.fly.dev",gc="jtbd_jan26";async function vc(){try{const r=await He().getPref(_e.INSTALL_ID);if(r?.value)return String(r.value)}catch{}return""}const Qn="__INTERVIEW_COMPLETE__";async function*hr(t){const r=t.body?.getReader();if(!r)throw new Error("Response body is not readable");const s=new TextDecoder;let n="";try{for(;;){const{done:a,value:o}=await r.read();if(a)break;n+=s.decode(o,{stream:!0});const l=n.split(`
`);n=l.pop()??"";for(const i of l){if(!i.startsWith("data: "))continue;const d=i.slice(6);if(d==="[DONE]")return;try{const m=JSON.parse(d);if(m.type==="text-delta"&&m.delta)yield m.delta;else if(m.type==="interview_complete")yield Qn;else if(m.type==="error"&&m.errorText)throw new Error(m.errorText)}catch(m){if(m instanceof Error&&m.message!=="Unexpected end of JSON input")throw m}}}}finally{r.releaseLock()}}function yc(){const[t,r]=u.useState("idle"),[s,n]=u.useState([]),[a,o]=u.useState(!1),[l,i]=u.useState(null),d=u.useRef(null),m=u.useRef(null),h=E=>{n(w=>[...w,E])},y=E=>{n(w=>{if(w.length===0)return w;const v=[...w];return v[v.length-1]={...v[v.length-1],content:E},v})},C=async()=>{r("active"),i(null),o(!0);const E=crypto.randomUUID();h({id:E,role:"assistant",content:""}),m.current=new AbortController;try{const w=await vc(),v=await fetch(`${fr}/api/interview/start`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({installId:w,experimentId:gc}),signal:m.current.signal});if(!v.ok)throw new Error(`Failed to start interview: ${v.status}`);const p=v.headers.get("x-interview-session-id");if(p)d.current=p;else{const k=new Error("No session ID returned from server");i(k),r("error");return}let j="";for await(const k of hr(v))j+=k,y(j)}catch(w){if(w instanceof Error&&w.name==="AbortError")return;const v=w instanceof Error?w:new Error("Unknown error");i(v),r("error")}finally{o(!1),m.current=null}},x=async E=>{if(!d.current)return;const w=crypto.randomUUID();h({id:w,role:"user",content:E});const v=crypto.randomUUID();h({id:v,role:"assistant",content:""}),o(!0),i(null),m.current=new AbortController;try{const p=await fetch(`${fr}/api/interview/${d.current}/respond`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({response:E}),signal:m.current.signal});if(!p.ok)throw new Error(`Failed to respond: ${p.status}`);let j="",k=!1;for await(const B of hr(p)){if(B===Qn){k=!0;continue}j+=B,y(j)}k&&r("completed")}catch(p){if(p instanceof Error&&p.name==="AbortError")return;const j=p instanceof Error?p:new Error("Unknown error");i(j),r("error")}finally{o(!1),m.current=null}},_=()=>{m.current?.abort(),o(!1)};return{phase:t,messages:s,isStreaming:a,error:l,start:C,respond:x,stop:_,reset:()=>{_(),n([]),i(null),d.current=null,r("idle")}}}const bc=({onReset:t})=>e.jsxs("div",{className:"rounded-xl border border-border bg-card p-8 text-center shadow-sm",children:[e.jsx("div",{className:"mx-auto mb-4 flex h-16 w-16 items-center justify-center rounded-full bg-green-500/10",children:e.jsx(ks,{className:"h-8 w-8 text-green-500"})}),e.jsx("h3",{className:"mb-2 font-semibold text-lg",children:"Thank You!"}),e.jsx("p",{className:"mx-auto mb-6 max-w-md text-muted-foreground text-sm",children:"Your feedback helps us build better products. We appreciate you taking the time to share your experience."}),e.jsxs(V,{onClick:t,variant:"outline",children:[e.jsx(Ds,{className:"mr-2 h-4 w-4"}),"Start Another Survey"]})]}),jc=({error:t,onRetry:r})=>e.jsxs("div",{className:"rounded-xl border border-destructive/50 bg-destructive/10 p-6 text-center",children:[e.jsx("div",{className:"mx-auto mb-4 flex h-12 w-12 items-center justify-center rounded-full bg-destructive/20",children:e.jsx(Rr,{className:"h-6 w-6 text-destructive"})}),e.jsx("h3",{className:"mb-2 font-semibold text-destructive",children:"Something went wrong"}),e.jsx("p",{className:"mb-4 text-muted-foreground text-sm",children:t.message}),e.jsxs(V,{onClick:r,variant:"outline",children:[e.jsx(Ds,{className:"mr-2 h-4 w-4"}),"Try Again"]})]}),wc=()=>{const t=yc();return e.jsxs("div",{className:"fade-in slide-in-from-bottom-5 animate-in space-y-6 duration-500",children:[e.jsx(pc,{}),t.phase==="idle"&&e.jsx(xc,{onStart:t.start,isLoading:t.isStreaming}),t.phase==="active"&&e.jsx(hc,{messages:t.messages,isStreaming:t.isStreaming,onSendMessage:t.respond,onStop:t.stop}),t.phase==="completed"&&e.jsx(bc,{onReset:t.reset}),t.phase==="error"&&t.error&&e.jsx(jc,{error:t.error,onRetry:t.reset})]})},Sc=[{name:"BrowserOS AI",to:"/ai",icon:uo,enabled:!0},{name:"LLM Chat & Hub",to:"/chat",icon:Mr,enabled:!0},{name:"Connect to MCPs",to:"/connect-mcp",icon:zo,enabled:!0,feature:Ut.MANAGED_MCP_SUPPORT},{name:"BrowserOS as MCP",to:"/mcp",icon:lt,enabled:!0},{name:"Scheduled Tasks",to:"/scheduled",icon:Lr,enabled:!0},{name:"Customization",to:"/customization",icon:Fr,enabled:!0,feature:Ut.CUSTOMIZATION_SUPPORT},{name:"Product Survey",to:"/jtbd-agent",icon:Ur,enabled:!1},{name:"Revisit Onboarding",to:chrome.runtime.getURL("onboarding.html"),icon:Ds,target:"_blank",enabled:!0},{name:"Search Engines",to:"/search",icon:Na,enabled:!1}],Nc=()=>{const t=Ca(),[r,s]=u.useState(!1),{supports:n}=Ps();return u.useEffect(()=>{Se(mo,{page:t.pathname})},[t.pathname]),e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsxs("div",{className:"sticky top-0 z-40 flex items-center justify-between border-border border-b bg-background px-4 py-3 lg:hidden",children:[e.jsx("h1",{className:"font-semibold text-lg",children:"Settings"}),e.jsx("div",{className:"flex items-center gap-1",children:e.jsx("button",{type:"button",onClick:()=>s(!r),className:"rounded-lg p-2 transition-colors hover:bg-accent","aria-label":"Toggle menu",children:r?e.jsx(Sr,{className:"h-5 w-5"}):e.jsx(Ro,{className:"h-5 w-5"})})})]}),r&&e.jsx("div",{className:"fixed inset-0 z-40 bg-black/50 lg:hidden",onClick:()=>s(!1),"aria-label":"Close sidebar",role:"button",tabIndex:0,onKeyDown:a=>{(a.key==="Enter"||a.key===" ")&&(a.preventDefault(),s(!1))}}),e.jsxs("div",{className:"flex",children:[e.jsx("aside",{className:`fixed inset-y-0 left-0 z-50 w-64 transform border-border border-r bg-background transition-transform duration-300 lg:sticky lg:top-0 lg:h-screen lg:translate-x-0 ${r?"translate-x-0":"-translate-x-full"}`,children:e.jsxs("div",{className:"flex h-full flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between border-border border-b px-6 py-4",children:[e.jsx("h1",{className:"font-semibold text-xl",children:"Settings"}),e.jsx(fo,{})]}),e.jsx("nav",{className:"flex-1 space-y-1 overflow-y-auto px-3 py-4",children:Sc.filter(a=>a.enabled&&(!a.feature||n(a.feature))).map(a=>{const o=t.pathname===a.to,l=a.icon;return e.jsxs(_a,{to:a.to,onClick:()=>s(!1),target:a.target,rel:a.target?"noopener noreferrer":void 0,className:`flex items-center gap-3 rounded-lg px-3 py-2.5 font-medium text-sm transition-all ${o?"bg-accent text-accent-foreground shadow-sm":"text-muted-foreground hover:bg-accent/50 hover:text-accent-foreground"}`,children:[e.jsx(l,{className:"h-4 w-4 shrink-0"}),e.jsx("span",{children:a.name})]},a.to)})}),e.jsx("div",{className:"border-border border-t px-3 py-4",children:e.jsxs("a",{href:"https://docs.browseros.com/",target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-3 rounded-lg px-3 py-2.5 font-medium text-muted-foreground text-sm transition-colors hover:bg-accent/50 hover:text-accent-foreground",children:[e.jsx(Ea,{className:"h-4 w-4 shrink-0"}),e.jsx("span",{children:"About BrowserOS"})]})})]})}),e.jsx("main",{className:"flex-1 overflow-y-auto",children:e.jsx("div",{className:"mx-auto max-w-5xl overflow-hidden px-4 py-8 sm:px-6 lg:px-8",children:e.jsx(Ta,{})})})]})]})},Cs=[{name:"ChatGPT",url:"https://chatgpt.com"},{name:"Claude",url:"https://claude.ai"},{name:"Grok",url:"https://grok.com"},{name:"Gemini",url:"https://gemini.google.com"},{name:"Perplexity",url:"https://www.perplexity.ai"}];async function Cc(){try{const s=(await He().getPref(_e.THIRD_PARTY_LLM_PROVIDERS))?.value||[];return s.length===0?Cs:s}catch{return Cs}}async function pr(t){try{return await He().setPref(_e.THIRD_PARTY_LLM_PROVIDERS,t)}catch{return!1}}function _c(t,r=128){try{const s=t.trim();return s?`https://www.google.com/s2/favicons?domain=${new URL(s.match(/^[a-zA-Z][a-zA-Z0-9+.-]*:/)?s:`https://${s}`).hostname}&sz=${r}`:void 0}catch{return}}function Ec(){const[t,r]=u.useState([]),[s,n]=u.useState(!0);u.useEffect(()=>{(async()=>{n(!0);try{const i=await Cc();r(i)}catch{r(Cs)}finally{n(!1)}})()},[]);const a=u.useCallback(async(l,i)=>{const m=i!==void 0&&i>=0?t.map((C,x)=>x===i?l:C):[...t,l],h=t;r(m),await pr(m)||r(h)},[t]),o=u.useCallback(async l=>{if(t.length<=1)return;const i=t.filter((h,y)=>y!==l),d=t;r(i),await pr(i)||r(d)},[t]);return{providers:t,isLoading:s,saveProvider:a,deleteProvider:o}}const Tc=Jt({name:he().min(1,"Provider name is required").max(50,"Name must be 50 characters or less"),url:he().min(1,"URL is required").refine(t=>{try{return new URL(t.startsWith("http")?t:`https://${t}`),!0}catch{return!1}},{message:"Please enter a valid URL"})}),kc=({open:t,onOpenChange:r,initialValues:s,onSave:n})=>{const a=!!s,o=as({resolver:os(Tc),defaultValues:{name:"",url:""}});u.useEffect(()=>{t&&o.reset(s?{name:s.name,url:s.url}:{name:"",url:""})},[t,s,o]);const l=i=>{let d=i.url.trim();!d.startsWith("http://")&&!d.startsWith("https://")&&(d=`https://${d}`),d.endsWith("/")&&(d=d.slice(0,-1)),n({name:i.name.trim(),url:d}),a||Se(ho,{name:i.name.trim(),url:d}),o.reset(),r(!1)};return e.jsx(Et,{open:t,onOpenChange:r,children:e.jsxs(Tt,{className:"sm:max-w-md",children:[e.jsxs(kt,{children:[e.jsx(It,{children:a?"Edit Provider":"Add Custom Provider"}),e.jsx(At,{children:a?"Update your custom AI chat provider.":"Add a new AI chat provider for quick access."})]}),e.jsx(ls,{...o,children:e.jsxs("form",{onSubmit:o.handleSubmit(l),className:"space-y-4",children:[e.jsx(ee,{control:o.control,name:"name",render:({field:i})=>e.jsxs(te,{children:[e.jsx(se,{children:"Provider Name"}),e.jsx(J,{children:e.jsx(de,{placeholder:"e.g., DeepSeek",...i})}),e.jsx(re,{})]})}),e.jsx(ee,{control:o.control,name:"url",render:({field:i})=>e.jsxs(te,{children:[e.jsx(se,{children:"URL"}),e.jsx(J,{children:e.jsx(de,{placeholder:"e.g., chat.deepseek.com",...i})}),e.jsx(Ue,{children:"The web address of the AI chat service"}),e.jsx(re,{})]})}),e.jsxs(Gt,{className:"gap-2 pt-2",children:[e.jsx(V,{type:"button",variant:"outline",onClick:()=>r(!1),children:"Cancel"}),e.jsx(V,{type:"submit",children:a?"Update":"Add"})]})]})})]})})},Ic=({provider:t,canDelete:r,onEdit:s,onDelete:n})=>{const a=u.useMemo(()=>_c(t.url),[t.url]);return e.jsxs("div",{className:"group flex w-full items-center gap-4 rounded-xl border border-border bg-card p-4 transition-all hover:border-[var(--accent-orange)] hover:shadow-md",children:[e.jsx("div",{className:"flex h-10 w-10 shrink-0 items-center justify-center overflow-hidden rounded-lg bg-muted",children:a?e.jsx("img",{src:a,alt:`${t.name} icon`,className:"h-full w-full object-cover"}):e.jsx(Ao,{className:"h-5 w-5 text-muted-foreground"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("span",{className:"mb-0.5 block truncate font-semibold",children:t.name}),e.jsx("p",{className:"truncate text-muted-foreground/70 text-xs",children:t.url})]}),e.jsxs("div",{className:"flex shrink-0 items-center gap-2",children:[e.jsx(V,{variant:"outline",size:"sm",onClick:s,children:"Edit"}),e.jsx(V,{variant:"ghost",size:"icon-sm",disabled:!r,className:"text-muted-foreground hover:bg-destructive/10 hover:text-destructive disabled:opacity-30",onClick:n,"aria-label":`Remove ${t.name}`,children:e.jsx(Qt,{className:"h-4 w-4"})})]})]})},Ac=({providers:t,isLoading:r=!1,onEditProvider:s,onDeleteProvider:n,onAddProvider:a})=>r?e.jsx("div",{className:"rounded-xl border border-border bg-card p-6 shadow-sm",children:e.jsxs("div",{className:"flex items-center justify-center gap-3 py-8 text-muted-foreground",children:[e.jsx(De,{className:"h-5 w-5 animate-spin"}),e.jsx("span",{children:"Loading providers..."})]})}):t.length===0?e.jsxs("div",{className:"rounded-xl border border-border bg-card p-6 shadow-sm",children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[e.jsx("h3",{className:"font-medium",children:"Configured Providers"}),e.jsxs(V,{variant:"outline",size:"sm",onClick:a,className:"border-[var(--accent-orange)] bg-[var(--accent-orange)]/10 text-[var(--accent-orange)] hover:bg-[var(--accent-orange)]/20 hover:text-[var(--accent-orange)]",children:[e.jsx(Ke,{className:"mr-1.5 h-4 w-4"}),"Add provider"]})]}),e.jsx("div",{className:"rounded-lg border border-border border-dashed py-8 text-center",children:e.jsx("p",{className:"text-muted-foreground text-sm",children:"No providers configured yet."})})]}):e.jsxs("div",{className:"rounded-xl border border-border bg-card p-6 shadow-sm",children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[e.jsx("h3",{className:"font-medium",children:"Configured Providers"}),e.jsxs(V,{variant:"outline",size:"sm",onClick:a,className:"border-[var(--accent-orange)] bg-[var(--accent-orange)]/10 text-[var(--accent-orange)] hover:bg-[var(--accent-orange)]/20 hover:text-[var(--accent-orange)]",children:[e.jsx(Ke,{className:"mr-1.5 h-4 w-4"}),"Add provider"]})]}),e.jsx("div",{className:"space-y-3",children:t.map((o,l)=>e.jsx(Ic,{provider:o,canDelete:t.length>1,onEdit:()=>s(l),onDelete:()=>n(l)},o.url))})]}),Pc=()=>e.jsx("div",{className:"rounded-xl border border-border bg-card p-6 shadow-sm transition-all hover:shadow-md",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"flex h-12 w-12 shrink-0 items-center justify-center rounded-xl bg-[var(--accent-orange)]/10",children:e.jsx(Mr,{className:"h-6 w-6 text-[var(--accent-orange)]"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"mb-1 font-semibold text-xl",children:"LLM Chat & Hub"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"Curate and configure your favourite LLM chat providers"})]})]})}),Dc=()=>{const{providers:t,isLoading:r,saveProvider:s,deleteProvider:n}=Ec(),[a,o]=u.useState(!1),[l,i]=u.useState(null),[d,m]=u.useState(null),h=()=>{i(null),o(!0)},y=w=>{i(w),o(!0)},C=w=>{m(w)},x=async()=>{d!==null&&(await n(d),m(null))},_=async w=>{await s(w,l??void 0)},b=d!==null?t[d]:null,E=l!==null?t[l]:null;return e.jsxs("div",{className:"fade-in slide-in-from-bottom-5 animate-in space-y-6 duration-500",children:[e.jsx(Pc,{}),e.jsx(Ac,{providers:t,isLoading:r,onEditProvider:y,onDeleteProvider:C,onAddProvider:h}),e.jsx(kc,{open:a,onOpenChange:o,initialValues:E,onSave:_}),e.jsx(yt,{open:d!==null,onOpenChange:w=>!w&&m(null),children:e.jsxs(bt,{children:[e.jsxs(jt,{children:[e.jsx(St,{children:"Remove Provider"}),e.jsxs(Nt,{children:["Remove ",b?.name," from your LLM chat providers?"]})]}),e.jsxs(wt,{children:[e.jsx(_t,{children:"Cancel"}),e.jsx(Ct,{onClick:x,children:"Remove"})]})]})})]})},{sendMessage:_s}=qa(),Rc="https://docs.browseros.com/browseros-mcp/how-to-guide",Mc=({serverUrl:t,isLoading:r,error:s})=>{const[n,a]=u.useState(!1),o=async()=>{if(t)try{await navigator.clipboard.writeText(t),a(!0),setTimeout(()=>a(!1),2e3)}catch{}};return e.jsx("div",{className:"rounded-xl border border-border bg-card p-6 shadow-sm transition-all hover:shadow-md",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"flex h-12 w-12 shrink-0 items-center justify-center rounded-xl bg-[var(--accent-orange)]/10",children:e.jsx(lt,{className:"h-6 w-6 text-[var(--accent-orange)]"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"mb-1 flex items-center justify-between",children:[e.jsx("h2",{className:"font-semibold text-xl",children:"BrowserOS MCP Server"}),e.jsxs("a",{href:Rc,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 text-muted-foreground text-sm transition-colors hover:text-[var(--accent-orange)]",children:["Setup a client",e.jsx(Or,{className:"h-3.5 w-3.5"})]})]}),e.jsx("p",{className:"mb-6 text-muted-foreground text-sm",children:"Connect BrowserOS to MCP clients like claude code, gemini and others."}),e.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center",children:[e.jsx("span",{className:"whitespace-nowrap font-medium text-sm",children:"Server URL:"}),e.jsxs("div",{className:"flex flex-1 items-center gap-2",children:[e.jsx("div",{className:"flex-1 rounded-lg border border-border bg-background px-3 py-2 font-mono text-sm sm:max-w-md",children:r?e.jsx("span",{className:"text-muted-foreground",children:"Loading..."}):s?e.jsx("span",{className:"text-destructive",children:s}):t}),e.jsx(V,{variant:"outline",size:"icon",onClick:o,disabled:!t||r,className:"shrink-0",children:n?e.jsx(qt,{className:"h-4 w-4 text-green-600"}):e.jsx(po,{className:"h-4 w-4"})})]})]})]})]})})},Lc=({tools:t,isLoading:r,error:s,onRefresh:n})=>{const[a,o]=u.useState(!1);return e.jsx(Yt,{open:a,onOpenChange:o,className:"group/collapsible",children:e.jsxs("div",{className:"rounded-xl border border-border bg-card p-6 shadow-sm transition-all hover:shadow-md",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs(Zt,{className:"flex flex-1 items-center justify-between text-left",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg",children:"Available Tools"}),t.length>0&&e.jsxs("p",{className:"text-muted-foreground text-sm",children:[t.length," tools available"]})]}),e.jsx(ct,{className:`h-5 w-5 text-muted-foreground transition-transform duration-200 ${a?"rotate-180":""}`})]}),e.jsx(V,{variant:"outline",size:"icon",onClick:n,disabled:r,className:"border-[var(--accent-orange)] bg-[var(--accent-orange)]/10 text-[var(--accent-orange)] hover:bg-[var(--accent-orange)]/20 hover:text-[var(--accent-orange)]",title:"Refresh tools",children:r?e.jsx(De,{className:"h-4 w-4 animate-spin"}):e.jsx(Er,{className:"h-4 w-4"})})]}),s&&e.jsx("div",{className:"mt-4 rounded-lg border border-destructive/20 bg-destructive/10 px-4 py-3 text-destructive text-sm",children:s}),e.jsx(Xt,{className:"pt-4",children:t.length>0&&e.jsx("div",{className:"grid gap-3 sm:grid-cols-2 lg:grid-cols-3",children:t.map(l=>e.jsxs("div",{className:"rounded-lg border border-border bg-background p-4 transition-all hover:border-[var(--accent-orange)]/50 hover:shadow-sm",children:[e.jsxs("div",{className:"mb-2 flex items-center gap-2",children:[e.jsx(Jo,{className:"h-4 w-4 text-[var(--accent-orange)]"}),e.jsx("span",{className:"font-medium text-sm",children:l.name})]}),l.description&&e.jsx("p",{className:"line-clamp-2 text-muted-foreground text-xs",children:l.description})]},l.name))})})]})})},Oc=ka("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function Uc({className:t,variant:r,...s}){return e.jsx("div",{"data-slot":"alert",role:"alert",className:q(Oc({variant:r}),t),...s})}function Fc({className:t,...r}){return e.jsx("div",{"data-slot":"alert-title",className:q("col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight",t),...r})}function Vc({className:t,...r}){return e.jsx("div",{"data-slot":"alert-description",className:q("col-start-2 grid justify-items-start gap-1 text-muted-foreground text-sm [&_p]:leading-relaxed",t),...r})}const Bc=6e4,xr=2e3,zc=15e3,Hc=({onServerRestart:t})=>{const[r,s]=u.useState(!1),[n,a]=u.useState(!0),[o,l]=u.useState(!1),[i,d]=u.useState("Restarting server..."),[m,h]=u.useState(null),[y,C]=u.useState(null);u.useEffect(()=>{(async()=>{try{const k=await He().getPref(_e.ALLOW_REMOTE_MCP);s(k?.value===!0)}catch{}finally{a(!1)}})()},[]);const x=u.useCallback(async()=>{try{return(await _s("checkHealth",void 0)).healthy}catch{return!1}},[]),_=u.useCallback(async()=>{const p=Date.now();return new Promise(j=>{const k=async()=>{const B=Date.now()-p;if(B>=Bc){j(!1);return}if(B>=zc&&d("Taking longer than expected..."),await x()){j(!0);return}setTimeout(k,xr)};setTimeout(k,xr)})},[x]),b=p=>{p?h("enable-remote"):E(!1)},E=async p=>{l(!0),d("Restarting server..."),h(null),C(null);try{if(!await He().setPref(_e.ALLOW_REMOTE_MCP,p))throw new Error("Failed to update setting");await _()?(s(p),Se(p?xo:go),Fe.success("Server restarted successfully",{description:p?"Remote connections are now enabled":"Remote connections are now disabled"}),t?.()):C("Server did not respond. Please quit and restart the browser, then try again.")}catch(j){C(j instanceof Error?j.message:"Failed to update setting")}finally{l(!1)}},w=()=>{h("restart")},v=async()=>{l(!0),d("Restarting server..."),h(null),C(null);try{await He().setPref(_e.RESTART_SERVER,!0),await _()?(Se(vo),Fe.success("Server restarted successfully"),t?.()):C("Server did not respond. Please quit and restart the browser, then try again.")}catch(p){C(p instanceof Error?p.message:"Failed to restart server")}finally{l(!1)}};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative rounded-xl border border-border bg-card p-6 shadow-sm transition-all hover:shadow-md",children:[o&&e.jsxs("div",{className:"absolute inset-0 z-10 flex flex-col items-center justify-center rounded-xl bg-card/80 backdrop-blur-sm",children:[e.jsx(De,{className:"h-8 w-8 animate-spin text-[var(--accent-orange)]"}),e.jsx("p",{className:"mt-3 font-medium text-sm",children:i})]}),e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"flex h-12 w-12 shrink-0 items-center justify-center rounded-xl bg-[var(--accent-orange)]/10",children:e.jsx(Co,{className:"h-6 w-6 text-[var(--accent-orange)]"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"mb-1 font-semibold text-xl",children:"MCP Server Settings"}),e.jsx("p",{className:"mb-6 text-muted-foreground text-sm",children:"Configure local MCP server options"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(pt,{htmlFor:"allow-remote",className:"font-medium text-sm",children:"Allow External Access"}),e.jsx("p",{className:"text-muted-foreground text-xs",children:"Allow MCP clients from other devices to connect"})]}),e.jsx(vt,{id:"allow-remote",checked:r,onCheckedChange:b,disabled:n||o})]}),e.jsxs("div",{className:"flex items-center justify-between border-border border-t pt-4",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx("span",{className:"font-medium text-sm",children:"Restart MCP Server"}),e.jsx("p",{className:"text-muted-foreground text-xs",children:"Restart local MCP server"})]}),e.jsxs(V,{variant:"outline",size:"sm",onClick:w,disabled:n||o,children:[e.jsx(Er,{className:"mr-2 h-4 w-4"}),"Restart"]})]}),y&&e.jsxs(Uc,{variant:"destructive",className:"mt-4 border-red-200 bg-red-50 dark:border-red-900 dark:bg-red-950",children:[e.jsx(Rr,{className:"h-4 w-4"}),e.jsxs(Fc,{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Server Error"}),e.jsx("button",{type:"button",onClick:()=>C(null),className:"-mt-1 -mr-1 rounded-sm p-1 opacity-70 transition-opacity hover:opacity-100",children:e.jsx(Sr,{className:"h-4 w-4"})})]}),e.jsx(Vc,{children:y})]})]})]})]})]}),e.jsx(yt,{open:m==="enable-remote",onOpenChange:p=>!p&&h(null),children:e.jsxs(bt,{children:[e.jsxs(jt,{children:[e.jsx(St,{children:"Allow External Access?"}),e.jsx(Nt,{children:"By default, the MCP server only accepts connections from localhost (127.0.0.1). Enabling this will allow any device on your network to connect. Only enable if you need to connect from another machine and trust your network."})]}),e.jsxs(wt,{children:[e.jsx(_t,{children:"Cancel"}),e.jsx(Ct,{onClick:()=>E(!0),children:"Enable"})]})]})}),e.jsx(yt,{open:m==="restart",onOpenChange:p=>!p&&h(null),children:e.jsxs(bt,{children:[e.jsxs(jt,{children:[e.jsx(St,{children:"Restart MCP Server?"}),e.jsx(Nt,{children:"This will restart the local MCP server. It may take 10-30 seconds to complete. Any active connections will be temporarily interrupted."})]}),e.jsxs(wt,{children:[e.jsx(_t,{children:"Cancel"}),e.jsx(Ct,{onClick:v,children:"Restart"})]})]})})]})},$c=()=>{const[t,r]=u.useState(null),[s,n]=u.useState(!0),[a,o]=u.useState(null),[l,i]=u.useState([]),[d,m]=u.useState(!1),[h,y]=u.useState(null),C=u.useCallback(async()=>{let _=null;n(!0),o(null),y(null);try{_=await za(),r(_),n(!1),m(!0);const b=await _s("fetchMcpTools",void 0);b.error?y(b.error):i(b.tools)}catch(b){const E=b instanceof Error?b.message:"Failed to load";_?y(E):o(E)}finally{n(!1),m(!1)}},[]);u.useEffect(()=>{C()},[C]);const x=async()=>{if(t){m(!0),y(null),i([]);try{const _=await _s("fetchMcpTools",void 0);_.error?y(_.error):i(_.tools)}catch(_){y(_ instanceof Error?_.message:"Failed to fetch tools")}finally{m(!1)}}};return e.jsxs("div",{className:"fade-in slide-in-from-bottom-5 animate-in space-y-6 duration-500",children:[e.jsx(Mc,{serverUrl:t,isLoading:s,error:a}),e.jsx(Hc,{onServerRestart:C}),e.jsx(Lc,{tools:l,isLoading:d,error:h,onRefresh:x})]})},Kc=Jt({name:he().min(1,"Name is required").max(100,"Name must be 100 characters or less"),query:he().min(1,"Prompt is required"),scheduleType:Cr(["daily","hourly","minutes"]),scheduleTime:he().optional(),scheduleInterval:ps().int().min(1).max(60).optional(),enabled:_r()}).superRefine((t,r)=>{t.scheduleType==="daily"&&!t.scheduleTime&&r.addIssue({code:Oe.custom,message:"Time is required for daily schedule",path:["scheduleTime"]}),(t.scheduleType==="hourly"||t.scheduleType==="minutes")&&(!t.scheduleInterval||t.scheduleInterval<1)&&r.addIssue({code:Oe.custom,message:"Interval must be at least 1",path:["scheduleInterval"]})}),Wc=({open:t,onOpenChange:r,initialValues:s,onSave:n})=>{const a=!!s,o=as({resolver:os(Kc),defaultValues:{name:"",query:"",scheduleType:"daily",scheduleTime:"09:00",scheduleInterval:1,enabled:!0}}),l=o.watch("scheduleType");u.useEffect(()=>{t&&(s?o.reset({name:s.name,query:s.query,scheduleType:s.scheduleType,scheduleTime:s.scheduleTime||"09:00",scheduleInterval:s.scheduleInterval||1,enabled:s.enabled}):o.reset({name:"",query:"",scheduleType:"daily",scheduleTime:"09:00",scheduleInterval:1,enabled:!0}))},[t,s,o]);const i=d=>{n({name:d.name.trim(),query:d.query.trim(),scheduleType:d.scheduleType,scheduleTime:d.scheduleType==="daily"?d.scheduleTime:void 0,scheduleInterval:d.scheduleType!=="daily"?d.scheduleInterval:void 0,enabled:d.enabled}),o.reset(),r(!1)};return e.jsx(Et,{open:t,onOpenChange:r,children:e.jsxs(Tt,{className:"sm:max-w-lg",children:[e.jsxs(kt,{children:[e.jsx(It,{children:a?"Edit Scheduled Task":"Create Scheduled Task"}),e.jsx(At,{children:a?"Update your scheduled task configuration.":"Create a new task that runs automatically on a schedule."})]}),e.jsx(ls,{...o,children:e.jsxs("form",{onSubmit:o.handleSubmit(i),className:"space-y-4",children:[e.jsx(ee,{control:o.control,name:"name",render:({field:d})=>e.jsxs(te,{children:[e.jsx(se,{children:"Name"}),e.jsx(J,{children:e.jsx(de,{placeholder:"e.g., Morning Briefing",...d})}),e.jsx(re,{})]})}),e.jsx(ee,{control:o.control,name:"query",render:({field:d})=>e.jsxs(te,{children:[e.jsx(se,{children:"Prompt"}),e.jsx(J,{children:e.jsx(Is,{placeholder:"What should the agent do? e.g., Check my email and summarize important messages",className:"min-h-[100px] resize-none",...d})}),e.jsx(Ue,{children:"The instruction that will be sent to the agent"}),e.jsx(re,{})]})}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsx(ee,{control:o.control,name:"scheduleType",render:({field:d})=>e.jsxs(te,{children:[e.jsx(se,{children:"Schedule"}),e.jsxs(Vt,{onValueChange:d.onChange,defaultValue:d.value,value:d.value,children:[e.jsx(J,{children:e.jsx(zt,{children:e.jsx(Bt,{placeholder:"Select schedule type"})})}),e.jsxs(Ht,{children:[e.jsx(ot,{value:"daily",children:"Daily at time"}),e.jsx(ot,{value:"hourly",children:"Every N hours"}),e.jsx(ot,{value:"minutes",children:"Every N minutes"})]})]}),e.jsx(re,{})]})}),l==="daily"?e.jsx(ee,{control:o.control,name:"scheduleTime",render:({field:d})=>e.jsxs(te,{children:[e.jsx(se,{children:"Time"}),e.jsx(J,{children:e.jsx(de,{type:"time",...d})}),e.jsx(re,{})]})}):e.jsx(ee,{control:o.control,name:"scheduleInterval",render:({field:d})=>e.jsxs(te,{children:[e.jsxs(se,{children:["Interval (",l==="hourly"?"hours":"minutes",")"]}),e.jsx(J,{children:e.jsx(de,{type:"number",min:1,max:l==="hourly"?24:60,value:d.value??"",onChange:m=>d.onChange(m.target.value?Number(m.target.value):void 0)})}),e.jsx(re,{})]})})]}),e.jsx(ee,{control:o.control,name:"enabled",render:({field:d})=>e.jsxs(te,{className:"flex flex-row items-center gap-3 space-y-0",children:[e.jsx(J,{children:e.jsx(Pr,{checked:d.value,onCheckedChange:d.onChange})}),e.jsx(se,{className:"font-normal",children:"Enable this task"})]})}),e.jsxs(Gt,{className:"gap-2 pt-2",children:[e.jsx(V,{type:"button",variant:"outline",onClick:()=>r(!1),children:"Cancel"}),e.jsx(V,{type:"submit",children:a?"Update":"Create"})]})]})})]})})},qc=({onAddClick:t})=>e.jsx("div",{className:"rounded-xl border border-border bg-card p-6 shadow-sm transition-all hover:shadow-md",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"flex h-12 w-12 shrink-0 items-center justify-center rounded-xl bg-[var(--accent-orange)]/10",children:e.jsx(Lr,{className:"h-6 w-6 text-[var(--accent-orange)]"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"mb-1 font-semibold text-xl",children:"Scheduled Tasks"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"Automate recurring browser tasks"})]}),e.jsxs(V,{onClick:t,className:"border-[var(--accent-orange)] bg-[var(--accent-orange)]/10 text-[var(--accent-orange)] hover:bg-[var(--accent-orange)]/20 hover:text-[var(--accent-orange)]",variant:"outline",children:[e.jsx(Ke,{className:"mr-1.5 h-4 w-4"}),"New Task"]})]})});Ye.extend(Ga);Ye.extend(_o);function Gc(t){return t.scheduleType==="daily"&&t.scheduleTime?`Daily at ${t.scheduleTime}`:t.scheduleType==="hourly"&&t.scheduleInterval?t.scheduleInterval===1?"Every hour":`Every ${t.scheduleInterval} hours`:t.scheduleType==="minutes"&&t.scheduleInterval?t.scheduleInterval===1?"Every minute":`Every ${t.scheduleInterval} minutes`:"Not scheduled"}const Jc=t=>Ye(t).fromNow();function Yc(t,r){if(!r)return"Running...";const s=Ye(r).diff(Ye(t)),n=Ye.duration(s),a=Math.floor(n.asMinutes()),o=n.seconds();return a===0?`${o}s`:`${a}m ${o}s`}const Zc=t=>Ye(t).format("MMM D, h:mm A"),Xc=({job:t,onEdit:r,onDelete:s,onToggle:n,onRun:a,onViewRun:o})=>{const[l,i]=u.useState(!1),{jobRuns:d}=Ja(),m=u.useMemo(()=>d.filter(h=>h.jobId===t.id).sort((h,y)=>new Date(y.startedAt).getTime()-new Date(h.startedAt).getTime()),[d,t.id]);return e.jsxs("div",{className:"rounded-xl border border-border bg-card p-4 shadow-sm transition-all hover:border-[var(--accent-orange)]/50 hover:shadow-sm",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx(vt,{checked:t.enabled,onCheckedChange:n,"aria-label":`${t.enabled?"Disable":"Enable"} ${t.name}`}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"mb-1 flex items-center gap-2",children:[e.jsx("span",{className:"truncate font-semibold",children:t.name}),!t.enabled&&e.jsx("span",{className:"rounded bg-muted px-1.5 py-0.5 text-muted-foreground text-xs",children:"Disabled"})]}),e.jsxs("p",{className:"mb-2 line-clamp-1 text-muted-foreground text-sm",children:['"',t.query,'"']}),e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground text-xs",children:[e.jsx("span",{children:Gc(t)}),t.lastRunAt&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"•"}),e.jsxs("span",{children:["Last run: ",Jc(t.lastRunAt)]})]})]})]}),e.jsxs("div",{className:"flex shrink-0 items-center gap-2",children:[e.jsxs(V,{variant:"outline",size:"sm",onClick:a,children:[e.jsx(Vo,{className:"mr-1.5 h-3 w-3"}),"Test"]}),e.jsxs(V,{variant:"outline",size:"sm",onClick:r,children:[e.jsx(Uo,{className:"mr-1.5 h-3 w-3"}),"Edit"]}),e.jsx(V,{variant:"ghost",size:"icon-sm",onClick:s,className:"text-muted-foreground hover:bg-destructive/10 hover:text-destructive","aria-label":`Delete ${t.name}`,children:e.jsx(Qt,{className:"h-4 w-4"})})]})]}),m.length>0&&e.jsxs(Yt,{open:l,onOpenChange:i,className:"mt-4",children:[e.jsxs(Zt,{className:"flex w-full items-center gap-2 text-muted-foreground text-sm hover:text-foreground",children:[e.jsx(ct,{className:`h-4 w-4 transition-transform duration-200 ${l?"rotate-180":""}`}),e.jsxs("span",{children:["Run History (",m.length,")"]})]}),e.jsx(Xt,{className:"pt-3",children:e.jsx("div",{className:"space-y-2",children:m.map(h=>e.jsxs("div",{className:"flex items-center gap-3 rounded-lg border border-border bg-background p-3",children:[h.status==="completed"?e.jsx(ks,{className:"h-4 w-4 shrink-0 text-green-500"}):h.status==="failed"?e.jsx(Dr,{className:"h-4 w-4 shrink-0 text-destructive"}):e.jsx(De,{className:"h-4 w-4 shrink-0 animate-spin text-accent-orange"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm",children:Zc(h.startedAt)}),e.jsx("span",{className:"text-muted-foreground text-xs",children:Yc(h.startedAt,h.completedAt)})]}),h.status==="failed"&&h.result&&e.jsx("p",{className:"mt-1 line-clamp-1 text-destructive text-xs",children:h.result})]}),e.jsx(V,{variant:"ghost",size:"sm",onClick:()=>o(h),className:"shrink-0 text-muted-foreground hover:text-foreground",children:"View"})]},h.id))})})]})]})},Qc=({jobs:t,onEdit:r,onDelete:s,onToggle:n,onRun:a,onViewRun:o})=>t.length===0?e.jsx("div",{className:"rounded-xl border border-border bg-card p-6 shadow-sm",children:e.jsx("div",{className:"rounded-lg border border-border border-dashed py-8 text-center",children:e.jsx("p",{className:"text-muted-foreground text-sm",children:"No scheduled tasks yet. Create one to automate recurring workflows."})})}):e.jsx("div",{className:"space-y-3",children:t.map(l=>e.jsx(Xc,{job:l,onEdit:()=>r(l),onDelete:()=>s(l.id),onToggle:i=>n(l.id,i),onRun:()=>a(l.id),onViewRun:o},l.id))}),ed=()=>{const{jobs:t,addJob:r,editJob:s,toggleJob:n,removeJob:a,runJob:o}=Ya(),[l,i]=u.useState(!1),[d,m]=u.useState(null),[h,y]=u.useState(null),[C,x]=u.useState(null),_=()=>{m(null),i(!0)},b=P=>{m(P),i(!0)},E=P=>{y(P)},w=async()=>{h&&(await a(h),y(null),Se(No))},v=async P=>{d?(await s(d.id,P),Se(wo,{scheduleType:P.scheduleType,interval:P.scheduleInterval,time:P.scheduleTime})):(await r(P),Se(So,{scheduleType:P.scheduleType,interval:P.scheduleInterval,time:P.scheduleTime}))},p=async(P,Y)=>{await n(P,Y),Se(jo)},j=async P=>{await o(P),Se(bo)},k=P=>{x(P),Se(yo)},B=h?t.find(P=>P.id===h):null;return e.jsxs("div",{className:"fade-in slide-in-from-bottom-5 animate-in space-y-6 duration-500",children:[e.jsx(qc,{onAddClick:_}),e.jsx(Qc,{jobs:t,onEdit:b,onDelete:E,onToggle:p,onRun:j,onViewRun:k}),e.jsx(Wc,{open:l,onOpenChange:i,initialValues:d,onSave:v}),e.jsx(Za,{run:C,jobName:C?t.find(P=>P.id===C.jobId)?.name:void 0,onOpenChange:P=>!P&&x(null)}),e.jsx(yt,{open:h!==null,onOpenChange:P=>!P&&y(null),children:e.jsxs(bt,{children:[e.jsxs(jt,{children:[e.jsx(St,{children:"Delete Scheduled Task"}),e.jsxs(Nt,{children:['Delete "',B?.name,'"? This will also remove all run history for this task.']})]}),e.jsxs(wt,{children:[e.jsx(_t,{children:"Cancel"}),e.jsx(Ct,{onClick:w,children:"Delete"})]})]})})]})};function td(){return new URLSearchParams(window.location.search).get("page")==="survey"?"/jtbd-agent":"/ai"}const sd=()=>{const t=td();return e.jsx(Ia,{children:e.jsx(Aa,{children:e.jsxs(Te,{element:e.jsx(Nc,{}),children:[e.jsx(Te,{index:!0,element:e.jsx(Pa,{to:t,replace:!0})}),e.jsx(Te,{path:"ai",element:e.jsx(dr,{},"ai")}),e.jsx(Te,{path:"chat",element:e.jsx(Dc,{})}),e.jsx(Te,{path:"search",element:null}),e.jsx(Te,{path:"connect-mcp",element:e.jsx(rc,{})}),e.jsx(Te,{path:"mcp",element:e.jsx($c,{})}),e.jsx(Te,{path:"customization",element:e.jsx(mc,{})}),e.jsx(Te,{path:"onboarding",element:e.jsx(dr,{},"onboarding")}),e.jsx(Te,{path:"scheduled",element:e.jsx(ed,{})}),e.jsx(Te,{path:"jtbd-agent",element:e.jsx(wc,{})})]})})})},gr=document.getElementById("root");gr&&Da.createRoot(gr,Ra).render(e.jsx(L.StrictMode,{children:e.jsx(Ma,{children:e.jsxs(La,{children:[e.jsx(sd,{}),e.jsx(Oa,{})]})})}));
